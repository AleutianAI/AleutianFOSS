# TOOL-HAPPY-FLASK: Tool Happy Path Tests (Python - Flask)
#
# One happy-path test per registered tool against the Flask web framework.
# Tests 6000-6022: Registered tools (expected_state: COMPLETE)
# Tests 6023-6039: Unregistered/TODO tools (expected_state: CLARIFY)

metadata:
  feature: TOOL-HAPPY-FLASK
  title: "Tool Happy Path - Flask"
  language: python
  project: flask
  project_root: ~/projects/crs_test_codebases/python/flask
  ticket: tickets/in_progress/integration_testing_outcomes_results_1a.md
  description: >
    Validates every registered graph tool against the Flask web framework.
    Each test exercises one tool with a project-specific query using real symbols.
    Flask is a Python micro web framework with WSGI routing and Jinja2 templating.

tests:
  # ── Registered Tools (00-22) ── expected_state: COMPLETE ──

  - id: 6000
    name: flask_find_callers
    category: TOOL_HAPPY_PATH
    description: >
      find_callers tool against Flask. Target: full_dispatch_request (app.py:904).
    query: |
      Who calls the full_dispatch_request function?
    expected_state: COMPLETE
    reference_answer: |
      full_dispatch_request has 3 callers: wsgi_app (the main WSGI entry point),
      test_bad_environ_raises_bad_request, and test_environ_for_valid_idna_completes.
      The production caller is wsgi_app; the other two are test functions that
      invoke it directly for error handling verification.
    validations:
      - type: graph_tool_used

  - id: 6001
    name: flask_find_callees
    category: TOOL_HAPPY_PATH
    description: >
      find_callees tool against Flask. Target: make_response (app.py:1129, complexity 16).
    query: |
      What functions does make_response call?
    expected_state: COMPLETE
    reference_answer: |
      make_response in app.py calls response_class, force_type, and various
      type-checking helpers to convert view return values into Response objects.
    validations:
      - type: graph_tool_used

  - id: 6002
    name: flask_find_implementations
    category: TOOL_HAPPY_PATH
    description: >
      find_implementations tool against Flask. Target: SessionInterface (sessions.py).
    query: |
      What classes implement the SessionInterface?
    expected_state: COMPLETE
    reference_answer: |
      SessionInterface in sessions.py is implemented by SecureCookieSessionInterface
      which provides the default cookie-based session handling.
    validations:
      - type: graph_tool_used

  - id: 6003
    name: flask_find_symbol
    category: TOOL_HAPPY_PATH
    description: >
      find_symbol tool against Flask. Target: Flask class (app.py:81).
    query: |
      Where is the Flask class defined?
    expected_state: COMPLETE
    reference_answer: |
      The Flask class is defined in app.py at line 81. It is the central
      application object that implements the WSGI interface.
    validations:
      - type: graph_tool_used

  - id: 6004
    name: flask_find_references
    category: TOOL_HAPPY_PATH
    description: >
      find_references tool against Flask. Target: request proxy (globals.py:46, 404 refs).
    query: |
      Where is the request proxy used across the codebase?
    expected_state: COMPLETE
    reference_answer: |
      The request proxy from globals.py is used extensively across flask modules
      including app.py, blueprints.py, helpers.py, and testing.py for accessing request context.
    validations:
      - type: graph_tool_used

  - id: 6005
    name: flask_get_call_chain
    category: TOOL_HAPPY_PATH
    description: >
      get_call_chain tool against Flask. From Flask.run to a view function.
    query: |
      Show the call chain from Flask.run to a view function
    expected_state: COMPLETE
    reference_answer: |
      Flask.run -> werkzeug.serving.run_simple -> wsgi_app -> full_dispatch_request ->
      dispatch_request -> view function execution via url_map routing.
    validations:
      - type: graph_tool_used

  - id: 6006
    name: flask_find_path
    category: TOOL_HAPPY_PATH
    description: >
      find_path tool against Flask. Between wsgi_app and dispatch_request.
    query: |
      Find the shortest path between wsgi_app and dispatch_request
    expected_state: COMPLETE
    reference_answer: |
      wsgi_app -> full_dispatch_request -> dispatch_request. The path goes
      through the main request handling pipeline in app.py.
    validations:
      - type: graph_tool_used

  - id: 6007
    name: flask_find_hotspots
    category: TOOL_HAPPY_PATH
    description: >
      find_hotspots tool against Flask.
    query: |
      What are the most connected functions (hotspots) in this codebase?
    expected_state: COMPLETE
    reference_answer: |
      Top hotspots include Flask.__init__, wsgi_app, full_dispatch_request,
      and make_response which serve as central hubs in request handling.
    validations:
      - type: graph_tool_used

  - id: 6008
    name: flask_find_dead_code
    category: TOOL_HAPPY_PATH
    description: >
      find_dead_code tool against Flask.
    query: |
      Find unused or dead code in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Dead code analysis finds functions with zero incoming edges that are
      not entry points, test helpers, or __init__ methods.
    validations:
      - type: graph_tool_used

  - id: 6009
    name: flask_find_cycles
    category: TOOL_HAPPY_PATH
    description: >
      find_cycles tool against Flask.
    query: |
      Find circular call dependencies in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Flask has limited call-graph cycles. The primary cycle is in
      templating.py where template rendering functions mutually call
      each other. This is a small codebase with simple call patterns.
    validations:
      - type: graph_tool_used

  - id: 6010
    name: flask_find_important
    category: TOOL_HAPPY_PATH
    description: >
      find_important tool (PageRank) against Flask.
    query: |
      What are the most important functions by PageRank in this codebase?
    expected_state: COMPLETE
    reference_answer: |
      PageRank identifies central functions in app.py (request dispatching),
      sessions.py (session management), and helpers.py (utility functions).
    validations:
      - type: graph_tool_used

  - id: 6011
    name: flask_find_communities
    category: TOOL_HAPPY_PATH
    description: >
      find_communities tool (Leiden) against Flask.
    query: |
      Find natural code communities and module boundaries in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Communities align with Flask's module structure: app (core), sessions,
      blueprints, templating, helpers, and the testing/cli utilities.
    validations:
      - type: graph_tool_used

  - id: 6012
    name: flask_find_articulation_points
    category: TOOL_HAPPY_PATH
    description: >
      find_articulation_points tool against Flask.
    query: |
      Find single points of failure in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Articulation points include key orchestration functions like wsgi_app
      and full_dispatch_request that bridge between routing and response handling.
    validations:
      - type: graph_tool_used

  - id: 6013
    name: flask_find_dominators
    category: TOOL_HAPPY_PATH
    description: >
      find_dominators tool against Flask. Target: dispatch_request.
    query: |
      What functions must be called before dispatch_request executes?
    expected_state: COMPLETE
    reference_answer: |
      Dominators of dispatch_request include wsgi_app and full_dispatch_request
      which must execute first to set up the request context.
    validations:
      - type: graph_tool_used

  - id: 6014
    name: flask_find_loops
    category: TOOL_HAPPY_PATH
    description: >
      find_loops tool against Flask. Target: blueprint registration.
    query: |
      Find recursive functions in the blueprint registration
    expected_state: COMPLETE
    reference_answer: |
      Recursive patterns exist in blueprint registration where nested blueprints
      trigger recursive register calls to build the URL rule hierarchy.
    validations:
      - type: graph_tool_used

  - id: 6015
    name: flask_find_merge_points
    category: TOOL_HAPPY_PATH
    description: >
      find_merge_points tool against Flask.
    query: |
      Where do different request handling paths converge?
    expected_state: COMPLETE
    reference_answer: |
      Merge points include make_response where different view return types
      (string, tuple, Response) converge into a single Response object.
    validations:
      - type: graph_tool_used

  - id: 6016
    name: flask_find_common_dependency
    category: TOOL_HAPPY_PATH
    description: >
      find_common_dependency tool against Flask. Between wsgi_app and Blueprint.register.
    query: |
      What shared dependency do wsgi_app and Blueprint.register have?
    expected_state: COMPLETE
    reference_answer: |
      Both wsgi_app and Blueprint.register depend on the Flask app object
      and its url_map for routing configuration and request dispatching.
    validations:
      - type: graph_tool_used

  - id: 6017
    name: flask_find_control_dependencies
    category: TOOL_HAPPY_PATH
    description: >
      find_control_dependencies tool against Flask. Target: before_request handlers.
    query: |
      What conditionals control whether before_request handlers run?
    expected_state: COMPLETE
    reference_answer: |
      before_request handlers are controlled by the request context setup
      and blueprint matching logic that determines which handlers apply.
    validations:
      - type: graph_tool_used

  - id: 6018
    name: flask_find_extractable_regions
    category: TOOL_HAPPY_PATH
    description: >
      find_extractable_regions tool against Flask. Target: full_dispatch_request.
    query: |
      Find functions that could be safely extracted from full_dispatch_request
    expected_state: COMPLETE
    reference_answer: |
      SESE regions in full_dispatch_request include the before_request processing,
      error handling, and after_request finalization blocks.
    validations:
      - type: graph_tool_used

  - id: 6019
    name: flask_check_reducibility
    category: TOOL_HAPPY_PATH
    description: >
      check_reducibility tool against Flask.
    query: |
      Check the control flow structure quality of this codebase
    expected_state: COMPLETE
    reference_answer: |
      Reducibility analysis shows the overall control flow graph structure,
      identifying any irreducible regions that complicate analysis.
    validations:
      - type: graph_tool_used

  - id: 6020
    name: flask_find_critical_path
    category: TOOL_HAPPY_PATH
    description: >
      find_critical_path tool against Flask. Target: HTTP request handling.
    query: |
      What is the mandatory call sequence to handle an HTTP request?
    expected_state: COMPLETE
    reference_answer: |
      The critical path goes through wsgi_app -> full_dispatch_request ->
      dispatch_request -> view function -> make_response -> finalize_request.
    validations:
      - type: graph_tool_used

  - id: 6021
    name: flask_find_module_api
    category: TOOL_HAPPY_PATH
    description: >
      find_module_api tool against Flask. Target: flask.sessions module.
    query: |
      What is the public API of the flask.sessions module?
    expected_state: COMPLETE
    reference_answer: |
      flask.sessions exports SessionInterface, SecureCookieSessionInterface,
      SecureCookieSession, and NullSession for session management.
    validations:
      - type: graph_tool_used

  - id: 6022
    name: flask_find_weighted_criticality
    category: TOOL_HAPPY_PATH
    description: >
      find_weighted_criticality tool against Flask.
    query: |
      What are the most critical functions by weighted importance?
    expected_state: COMPLETE
    reference_answer: |
      Weighted criticality combines PageRank, betweenness, and degree
      centrality to identify functions critical across multiple dimensions.
    validations:
      - type: graph_tool_used

  # ── Unregistered/TODO Tools (23-39) ── expected_state: CLARIFY ──

  - id: 6023
    name: flask_find_entry_points
    category: TOOL_HAPPY_PATH
    description: >
      find_entry_points tool against Flask. Find execution entry points.
    query: |
      What are the entry points into this codebase?
    expected_state: COMPLETE
    reference_answer: |
      Entry points include Flask.__call__/wsgi_app for WSGI handling,
      Flask.run() for development server, and CLI commands via FlaskGroup.
    validations:
      - type: graph_tool_used

  - id: 6024
    name: flask_trace_data_flow
    category: TOOL_HAPPY_PATH
    description: >
      trace_data_flow tool against Flask. Trace request data flow.
    query: |
      Trace how request data flows through the dispatch pipeline
    expected_state: COMPLETE
    reference_answer: |
      Request data flows from wsgi_app through request_context push,
      URL matching, before_request hooks, dispatch_request to the
      view function, then through after_request hooks to the response.
    validations:
      - type: graph_tool_used

  - id: 6025
    name: flask_trace_error_flow
    category: TOOL_HAPPY_PATH
    description: >
      trace_error_flow tool against Flask. Trace error propagation.
    query: |
      Trace how errors propagate through the request handling system
    expected_state: COMPLETE
    reference_answer: |
      Errors propagate from view functions through handle_user_exception,
      errorhandler lookup, and finally handle_exception which generates
      the error response with appropriate HTTP status codes.
    validations:
      - type: graph_tool_used

  - id: 6026
    name: flask_find_config_usage
    category: TOOL_HAPPY_PATH
    description: >
      find_config_usage tool against Flask. Find config usage.
    query: |
      How is the app configuration used across Flask?
    expected_state: COMPLETE
    reference_answer: |
      App configuration via app.config is used for SECRET_KEY in
      sessions, DEBUG mode behavior, template auto-reload, JSON
      settings, and error handling verbosity across Flask modules.
    validations:
      - type: graph_tool_used

  - id: 6027
    name: flask_find_similar_code
    category: TOOL_HAPPY_PATH
    description: >
      find_similar_code tool against Flask. Similar to dispatch logic.
    query: |
      Find code similar to the request dispatching logic
    expected_state: COMPLETE
    reference_answer: |
      Code similar to request dispatching exists in Blueprint dispatch,
      error handler dispatch, and the before/after request hook chains
      which all follow the same pattern of callback iteration.
    validations:
      - type: graph_tool_used

  - id: 6028
    name: flask_build_minimal_context
    category: TOOL_HAPPY_PATH
    description: >
      build_minimal_context tool against Flask. Context for wsgi_app.
    query: |
      Build minimal context needed to understand the wsgi_app function
    expected_state: COMPLETE
    reference_answer: |
      Minimal context includes Flask class, RequestContext, the URL
      map and Rule system, dispatch_request, and the before/after
      request hook mechanism.
    validations:
      - type: graph_tool_used

  - id: 6029
    name: flask_summarize_file
    category: TOOL_HAPPY_PATH
    description: >
      summarize_file tool against Flask. Summarize app.py.
    query: |
      Summarize the flask/app.py file
    expected_state: COMPLETE
    reference_answer: |
      app.py defines the Flask class, the central application object.
      It contains request dispatching, URL routing, error handling,
      template rendering, and the WSGI interface implementation.
    validations:
      - type: graph_tool_used

  - id: 6030
    name: flask_summarize_package
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: summarize_package tool (not yet registered as standalone tool).
    query: |
      Summarize the flask package and its modules
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 6031
    name: flask_analyze_change_impact
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: analyze_change_impact tool (not yet registered as standalone tool).
    query: |
      What would be the impact of changing the Flask.route decorator?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 6032
    name: flask_check_breaking_changes
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: check_breaking_changes tool (not yet registered as standalone tool).
    query: |
      Would removing the make_response method be a breaking change?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 6033
    name: flask_simulate_change
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: simulate_change tool (not yet registered as standalone tool).
    query: |
      Simulate the impact of refactoring full_dispatch_request into smaller methods
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 6034
    name: flask_find_test_coverage
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: find_test_coverage tool (not yet registered as standalone tool).
    query: |
      Which functions in flask/app.py lack test coverage?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 6035
    name: flask_detect_side_effects
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: detect_side_effects tool (not yet registered as standalone tool).
    query: |
      What side effects does the wsgi_app function have?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 6036
    name: flask_detect_patterns
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: detect_patterns tool (not yet registered as standalone tool).
    query: |
      What design patterns are used in this codebase?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 6037
    name: flask_find_code_smells
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: find_code_smells tool (not yet registered as standalone tool).
    query: |
      Find code smells in this codebase
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 6038
    name: flask_find_duplication
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: find_duplication tool (not yet registered as standalone tool).
    query: |
      Find duplicated code patterns in this codebase
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 6039
    name: flask_extract_conventions
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: extract_conventions tool (not yet registered as standalone tool).
    query: |
      What coding conventions does this codebase follow?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  # -- Additional find_callers tests (40-41) -- expected_state: COMPLETE --

  - id: 6040
    name: flask_find_callers_b
    category: TOOL_HAPPY_PATH
    description: >
      find_callers tool against Flask (test B). Target: finalize_request method.
    query: |
      Who calls the finalize_request method?
    expected_state: COMPLETE
    reference_answer: |
      finalize_request has 2 callers: handle_exception and full_dispatch_request.
      handle_exception calls it after error handler processing to finalize the
      error response, and full_dispatch_request calls it after successful view
      dispatch to run after_request hooks and build the final Response.
    validations:
      - type: graph_tool_used

  - id: 6041
    name: flask_find_callers_c
    category: TOOL_HAPPY_PATH
    description: >
      find_callers tool against Flask (test C). Target: create_url_adapter method.
    query: |
      Who calls the create_url_adapter method?
    expected_state: COMPLETE
    reference_answer: |
      create_url_adapter has 3 callers: url_for (builds URLs using the adapter),
      AppContext.__init__ (creates adapter for application context), and
      RequestContext.push (creates adapter for the incoming request context).
      Each caller needs a URL adapter to map between endpoints and URLs.
    validations:
      - type: graph_tool_used
  # -- Additional find_implementations tests (44-45) -- expected_state: COMPLETE --
  - id: 6044
    name: flask_find_implementations_b
    category: TOOL_HAPPY_PATH
    description: >
      find_implementations tool against Flask (test B). Target: View base class in views.py.
    query: |
      What classes extend the View base class in Flask?
    expected_state: COMPLETE
    reference_answer: |
      The View class in flask/views.py is extended by MethodView which provides
      HTTP method-based dispatching. MethodView maps HTTP methods (get, post, put,
      delete) to class methods for class-based view patterns.
    validations:
      - type: graph_tool_used

  - id: 6045
    name: flask_find_implementations_c
    category: TOOL_HAPPY_PATH
    description: >
      find_implementations tool against Flask (test C). Target: JSONTag class in json/tag.py.
    query: |
      What classes extend the JSONTag class for Flask's tagged JSON serializer?
    expected_state: COMPLETE
    reference_answer: |
      JSONTag in flask/json/tag.py is extended by TagDict, TagTuple, TagBytes,
      TagMarkup, TagUUID, TagDateTime, and TagList. Each handles serialization
      and deserialization of a specific Python type for session data.
    validations:
      - type: graph_tool_used

  # -- Additional find_callees tests (42-43) -- expected_state: COMPLETE --
  - id: 6042
    name: flask_find_callees_b
    category: TOOL_HAPPY_PATH
    description: >
      find_callees tool against Flask (test B). Target: full_dispatch_request method.

    query: |
      What functions does full_dispatch_request call?
    expected_state: COMPLETE
    reference_answer: |
      full_dispatch_request calls request_started.send to emit the signal,
      preprocess_request to run before_request hooks, dispatch_request
      to invoke the view function, handle_user_exception for error handling,
      and finalize_request to run after_request hooks and build the response.
    validations:
      - type: graph_tool_used

  - id: 6043
    name: flask_find_callees_c
    category: TOOL_HAPPY_PATH
    description: >
      find_callees tool against Flask (test C). Target: send_file function.

    query: |
      What functions does send_file call?
    expected_state: COMPLETE
    reference_answer: |
      send_file calls _prepare_send_file_kwargs to gather configuration
      like max_age and X-Sendfile settings, then delegates to
      werkzeug.utils.send_file to construct the file response.
    validations:
      - type: graph_tool_used

  # -- Additional find_symbol tests (46-47) -- expected_state: COMPLETE --

  - id: 6046
    name: flask_find_symbol_b
    category: TOOL_HAPPY_PATH
    description: >
      find_symbol tool against Flask (test B). Target: Blueprint class.
    query: |
      Where is the Blueprint class defined?
    expected_state: COMPLETE
    reference_answer: |
      The Blueprint class is defined in blueprints.py. It extends Scaffold and
      provides a way to organize related views, templates, and static files
      into reusable application components.
    validations:
      - type: graph_tool_used

  - id: 6047
    name: flask_find_symbol_c
    category: TOOL_HAPPY_PATH
    description: >
      find_symbol tool against Flask (test C). Target: Config class.
    query: |
      Where is the Config class defined?
    expected_state: COMPLETE
    reference_answer: |
      The Config class is defined in config.py. It extends dict and provides
      methods like from_envvar, from_pyfile, and from_object for loading
      application configuration from various sources.
    validations:
      - type: graph_tool_used

  # -- Additional find_references tests (48-49) -- expected_state: COMPLETE --

  - id: 6048
    name: flask_find_references_b
    category: TOOL_HAPPY_PATH
    description: >
      find_references tool against Flask (test B). Target: Blueprint class.
    query: |
      Where is the Blueprint class referenced across the Flask codebase?
    expected_state: COMPLETE
    reference_answer: |
      The Blueprint class is referenced in app.py for registration via
      register_blueprint, in blueprints.py for nested blueprint support,
      in helpers.py for URL building, and in testing.py for test client setup.
    validations:
      - type: graph_tool_used

  - id: 6049
    name: flask_find_references_c
    category: TOOL_HAPPY_PATH
    description: >
      find_references tool against Flask (test C). Target: Response class.
    query: |
      Where is the Response class used across the Flask codebase?
    expected_state: COMPLETE
    reference_answer: |
      The Response class from wrappers.py is used in app.py as the
      response_class attribute, in make_response for type coercion,
      in testing.py for test response assertions, and in helpers.py
      for redirect and send_file return types.
    validations:
      - type: graph_tool_used

  # -- Additional get_call_chain tests (50-51) -- expected_state: COMPLETE --

  - id: 6050
    name: flask_get_call_chain_b
    category: TOOL_HAPPY_PATH
    description: >
      get_call_chain tool against Flask (test B). Target: error handling path.
    query: |
      Show the call chain from wsgi_app through error handling to the error response
    expected_state: COMPLETE
    reference_answer: |
      wsgi_app -> full_dispatch_request -> handle_user_exception ->
      handle_exception -> find error handler -> make_response ->
      finalize_request to produce the error response.
    validations:
      - type: graph_tool_used

  - id: 6051
    name: flask_get_call_chain_c
    category: TOOL_HAPPY_PATH
    description: >
      get_call_chain tool against Flask (test C). Target: blueprint registration chain.
    query: |
      Show the call chain from Flask.register_blueprint to URL rule creation
    expected_state: COMPLETE
    reference_answer: |
      Flask.register_blueprint -> Blueprint.register -> Blueprint._merge_blueprint_mapping ->
      add_url_rule to install routing rules from the blueprint into the app.
    validations:
      - type: graph_tool_used

  # -- Additional find_path tests (52-53) -- expected_state: COMPLETE --

  - id: 6052
    name: flask_find_path_b
    category: TOOL_HAPPY_PATH
    description: >
      find_path tool against Flask (test B). Between url_for and redirect.
    query: |
      Find the shortest path between url_for and redirect
    expected_state: COMPLETE
    reference_answer: |
      url_for and redirect are both in helpers.py. redirect calls url_for
      indirectly when building redirect URLs, connecting through the
      werkzeug.utils.redirect helper that takes the generated URL.
    validations:
      - type: graph_tool_used

  - id: 6053
    name: flask_find_path_c
    category: TOOL_HAPPY_PATH
    description: >
      find_path tool against Flask (test C). Between Flask.__init__ and SessionInterface.
    query: |
      Find the shortest path between Flask initialization and session handling
    expected_state: COMPLETE
    reference_answer: |
      Flask.__init__ sets session_interface to SecureCookieSessionInterface.
      At request time, the path goes through wsgi_app -> RequestContext.push ->
      open_session which invokes session_interface.open_session.
    validations:
      - type: graph_tool_used

  # -- Additional find_hotspots tests (54-55) -- expected_state: COMPLETE --

  - id: 6054
    name: flask_find_hotspots_b
    category: TOOL_HAPPY_PATH
    description: >
      find_hotspots tool against Flask (test B). Target: blueprint subsystem.
    query: |
      What are the hotspots in the blueprint subsystem?
    expected_state: COMPLETE
    reference_answer: |
      In the blueprint subsystem, the most connected functions include
      Blueprint.register, Blueprint.record, and _merge_blueprint_mapping
      which serve as hubs during blueprint-to-app registration.
    validations:
      - type: graph_tool_used

  - id: 6055
    name: flask_find_hotspots_c
    category: TOOL_HAPPY_PATH
    description: >
      find_hotspots tool against Flask (test C). Target: session and context modules.
    query: |
      What are the hotspot functions in the Flask session and context management?
    expected_state: COMPLETE
    reference_answer: |
      Top hotspots by connectivity score include route (scaffold.py, high InDegree
      from decorator usage), register_blueprint (app.py), url_for (app.py),
      and test_client (app.py). These are the most connected functions
      across the Flask codebase.
    validations:
      - type: graph_tool_used

  # -- Additional find_dead_code tests (56-57) -- expected_state: COMPLETE --

  - id: 6056
    name: flask_find_dead_code_b
    category: TOOL_HAPPY_PATH
    description: >
      find_dead_code tool against Flask (test B). Target: helpers module.
    query: |
      Find dead code specifically in the Flask helpers module
    expected_state: COMPLETE
    reference_answer: |
      Dead code analysis of helpers.py may find deprecated helper functions
      that are no longer called internally, such as legacy URL building
      utilities or old-style template loading helpers.
    validations:
      - type: graph_tool_used

  - id: 6057
    name: flask_find_dead_code_c
    category: TOOL_HAPPY_PATH
    description: >
      find_dead_code tool against Flask (test C). Target: functions with zero callers.
    query: |
      Which functions in Flask have no incoming calls and are not public entry points?
    expected_state: COMPLETE
    reference_answer: |
      Functions with zero callers that are not entry points or __init__ methods
      include internal helper functions in views.py and json/tag.py that may
      only be reached via dynamic dispatch or external consumer code.
    validations:
      - type: graph_tool_used

  # -- Additional find_cycles tests (58-59) -- expected_state: COMPLETE --

  - id: 6058
    name: flask_find_cycles_b
    category: TOOL_HAPPY_PATH
    description: >
      find_cycles tool against Flask (test B). Target: request/response cycle.
    query: |
      Find circular dependencies in the request and response handling code
    expected_state: COMPLETE
    reference_answer: |
      Flask's request/response handling code does not contain function-level
      call cycles. The flow is linear: request dispatch to handler to response.
      The tool correctly finds no mutual recursion in this subsystem.
    validations:
      - type: graph_tool_used

  - id: 6059
    name: flask_find_cycles_c
    category: TOOL_HAPPY_PATH
    description: >
      find_cycles tool against Flask (test C). Target: session and context modules.
    query: |
      Are there any circular call dependencies in Flask's context and session code?
    expected_state: COMPLETE
    reference_answer: |
      Flask's context and session code does not contain function-level call
      cycles. While there are design-level dependencies between context and
      session modules, these are import dependencies not call-graph cycles.
    validations:
      - type: graph_tool_used

  # -- Additional find_important tests (60-61) -- expected_state: COMPLETE --

  - id: 6060
    name: flask_find_important_b
    category: TOOL_HAPPY_PATH
    description: >
      find_important tool against Flask (test B). Target: top 5 by betweenness centrality.
    query: |
      What are the top 5 most important functions by betweenness centrality?
    expected_state: COMPLETE
    reference_answer: |
      By betweenness centrality, key bridge functions include full_dispatch_request,
      finalize_request, make_response, and wsgi_app which sit on the most
      shortest paths between other function pairs in the call graph.
    validations:
      - type: graph_tool_used

  - id: 6061
    name: flask_find_important_c
    category: TOOL_HAPPY_PATH
    description: >
      find_important tool against Flask (test C). Target: helpers and templating modules.
    query: |
      What are the most important functions in Flask's helpers and templating modules?
    expected_state: COMPLETE
    reference_answer: |
      PageRank identifies url_for and render_template as the most important
      functions in these modules, as they are called widely across Flask
      applications and internal code for URL generation and template rendering.
    validations:
      - type: graph_tool_used

  # -- Additional find_communities tests (62-63) -- expected_state: COMPLETE --

  - id: 6062
    name: flask_find_communities_b
    category: TOOL_HAPPY_PATH
    description: >
      find_communities tool against Flask (test B). Target: community boundaries.
    query: |
      How many distinct code communities exist in Flask and what are their boundaries?
    expected_state: COMPLETE
    reference_answer: |
      Leiden community detection identifies clusters around app.py (core routing),
      blueprints.py (modular registration), sessions.py (session management),
      ctx.py (context stack), helpers.py (utilities), and json/ (serialization).
    validations:
      - type: graph_tool_used

  - id: 6063
    name: flask_find_communities_c
    category: TOOL_HAPPY_PATH
    description: >
      find_communities tool against Flask (test C). Target: cross-community coupling.
    query: |
      Which code communities in Flask are most tightly coupled to each other?
    expected_state: COMPLETE
    reference_answer: |
      The app.py community and blueprints.py community are tightly coupled
      through register_blueprint and add_url_rule. The ctx.py community
      is coupled to sessions.py through open_session and save_session calls.
    validations:
      - type: graph_tool_used

  # -- Additional find_articulation_points tests (64-65) -- expected_state: COMPLETE --

  - id: 6064
    name: flask_find_articulation_points_b
    category: TOOL_HAPPY_PATH
    description: >
      find_articulation_points tool against Flask (test B). Target: context management.
    query: |
      Find articulation points in Flask's context management code
    expected_state: COMPLETE
    reference_answer: |
      Articulation points in context management include RequestContext.push
      and AppContext.push, which are the sole bridges between the context
      stack and the request/session handling subsystems.
    validations:
      - type: graph_tool_used

  - id: 6065
    name: flask_find_articulation_points_c
    category: TOOL_HAPPY_PATH
    description: >
      find_articulation_points tool against Flask (test C). Target: functions whose removal disconnects the graph.
    query: |
      Which functions, if removed, would disconnect Flask's call graph into separate components?
    expected_state: COMPLETE
    reference_answer: |
      Removing full_dispatch_request would disconnect the WSGI entry point from
      view dispatch. Removing finalize_request would disconnect response building
      from after_request processing. These are critical bridge functions.
    validations:
      - type: graph_tool_used

  # -- Additional find_dominators tests (66-67) -- expected_state: COMPLETE --

  - id: 6066
    name: flask_find_dominators_b
    category: TOOL_HAPPY_PATH
    description: >
      find_dominators tool against Flask (test B). Target: make_response.
    query: |
      What functions must execute before make_response can be reached?
    expected_state: COMPLETE
    reference_answer: |
      Dominators of make_response include wsgi_app, full_dispatch_request,
      and dispatch_request. The request must pass through the full dispatch
      pipeline before a view return value can be converted into a response.
    validations:
      - type: graph_tool_used

  - id: 6067
    name: flask_find_dominators_c
    category: TOOL_HAPPY_PATH
    description: >
      find_dominators tool against Flask (test C). Target: save_session.
    query: |
      What functions dominate the save_session call?
    expected_state: COMPLETE
    reference_answer: |
      Dominators of save_session include wsgi_app and finalize_request.
      The session can only be saved during response finalization, which
      requires the full request pipeline to have executed first.
    validations:
      - type: graph_tool_used

  # -- Additional find_loops tests (68-69) -- expected_state: COMPLETE --

  - id: 6068
    name: flask_find_loops_b
    category: TOOL_HAPPY_PATH
    description: >
      find_loops tool against Flask (test B). Target: error handler resolution.
    query: |
      Find loops or recursive calls in Flask's error handler lookup
    expected_state: COMPLETE
    reference_answer: |
      Error handler lookup in _find_error_handler may involve recursive
      traversal through blueprint error handler chains and class hierarchy
      matching via MRO when resolving which handler matches an exception type.
    validations:
      - type: graph_tool_used

  - id: 6069
    name: flask_find_loops_c
    category: TOOL_HAPPY_PATH
    description: >
      find_loops tool against Flask (test C). Target: JSON tag serialization.
    query: |
      Find natural loops in the JSON tag serialization system
    expected_state: COMPLETE
    reference_answer: |
      The TaggedJSONSerializer.dumps and loads methods iterate over registered
      JSONTag subclasses, and complex nested structures may trigger recursive
      tag resolution when TagDict or TagList encounter nested tagged values.
    validations:
      - type: graph_tool_used

  # -- Additional find_merge_points tests (70-71) -- expected_state: COMPLETE --

  - id: 6070
    name: flask_find_merge_points_b
    category: TOOL_HAPPY_PATH
    description: >
      find_merge_points tool against Flask (test B). Target: error handling paths.
    query: |
      Where do Flask's different error handling paths converge?
    expected_state: COMPLETE
    reference_answer: |
      Error handling paths converge at handle_exception where HTTP exceptions,
      unhandled exceptions, and blueprint-level errors all merge before
      finalize_request produces the final error response.
    validations:
      - type: graph_tool_used

  - id: 6071
    name: flask_find_merge_points_c
    category: TOOL_HAPPY_PATH
    description: >
      find_merge_points tool against Flask (test C). Target: configuration loading paths.
    query: |
      Where do Flask's different configuration loading methods converge?
    expected_state: COMPLETE
    reference_answer: |
      Configuration loading paths from from_envvar, from_pyfile, from_object,
      and from_mapping all converge at the Config dict update mechanism,
      merging into the single app.config dictionary instance.
    validations:
      - type: graph_tool_used

  # -- Additional find_common_dependency tests (72-73) -- expected_state: COMPLETE --

  - id: 6072
    name: flask_find_common_dependency_b
    category: TOOL_HAPPY_PATH
    description: >
      find_common_dependency tool against Flask (test B). Between render_template and flash.
    query: |
      What shared dependency do render_template and flash have?
    expected_state: COMPLETE
    reference_answer: |
      Both render_template and flash depend on the request context stack.
      render_template needs it for template context globals, and flash
      needs it to access the session for storing flash messages.
    validations:
      - type: graph_tool_used

  - id: 6073
    name: flask_find_common_dependency_c
    category: TOOL_HAPPY_PATH
    description: >
      find_common_dependency tool against Flask (test C). Between send_file and url_for.
    query: |
      What shared dependency do send_file and url_for have?
    expected_state: COMPLETE
    reference_answer: |
      Both send_file and url_for depend on the current application context
      via current_app. send_file uses it for static file configuration
      and url_for uses it for URL map access and server name resolution.
    validations:
      - type: graph_tool_used

  # -- Additional find_control_dependencies tests (74-75) -- expected_state: COMPLETE --

  - id: 6074
    name: flask_find_control_dependencies_b
    category: TOOL_HAPPY_PATH
    description: >
      find_control_dependencies tool against Flask (test B). Target: teardown functions.
    query: |
      What conditionals control whether teardown functions execute?
    expected_state: COMPLETE
    reference_answer: |
      Teardown functions are controlled by the context pop logic in
      RequestContext.pop and AppContext.pop. The exc argument and
      PRESERVE_CONTEXT_ON_EXCEPTION config flag determine whether
      teardown handlers run immediately or are deferred.
    validations:
      - type: graph_tool_used

  - id: 6075
    name: flask_find_control_dependencies_c
    category: TOOL_HAPPY_PATH
    description: >
      find_control_dependencies tool against Flask (test C). Target: template rendering.
    query: |
      What control flow conditions determine how template rendering proceeds?
    expected_state: COMPLETE
    reference_answer: |
      Template rendering is controlled by whether the app has a custom
      jinja_loader, whether a blueprint-specific template folder exists,
      and the template_folder configuration. The Jinja2 environment
      selection depends on these conditions in templating.py.
    validations:
      - type: graph_tool_used

  # -- Additional find_extractable_regions tests (76-77) -- expected_state: COMPLETE --

  - id: 6076
    name: flask_find_extractable_regions_b
    category: TOOL_HAPPY_PATH
    description: >
      find_extractable_regions tool against Flask (test B). Target: wsgi_app method.
    query: |
      Find extractable regions in the wsgi_app method
    expected_state: COMPLETE
    reference_answer: |
      SESE regions in wsgi_app include the request context setup block,
      the try/except around full_dispatch_request, and the response
      iteration cleanup. Each has clear entry/exit points for extraction.
    validations:
      - type: graph_tool_used

  - id: 6077
    name: flask_find_extractable_regions_c
    category: TOOL_HAPPY_PATH
    description: >
      find_extractable_regions tool against Flask (test C). Target: Blueprint.register.
    query: |
      Find safely extractable code regions in Blueprint.register
    expected_state: COMPLETE
    reference_answer: |
      Blueprint.register contains extractable regions for name collision
      checking, deferred function execution, nested blueprint registration,
      and URL rule copying. Each region has independent entry/exit boundaries.
    validations:
      - type: graph_tool_used

  # -- Additional check_reducibility tests (78-79) -- expected_state: COMPLETE --

  - id: 6078
    name: flask_check_reducibility_b
    category: TOOL_HAPPY_PATH
    description: >
      check_reducibility tool against Flask (test B). Target: request handling subgraph.
    query: |
      Is the control flow in Flask's request handling pipeline reducible?
    expected_state: COMPLETE
    reference_answer: |
      The request handling pipeline (wsgi_app -> full_dispatch_request ->
      dispatch_request -> finalize_request) forms a mostly reducible control
      flow structure, with potential irreducibility in error recovery paths
      where handle_exception re-enters the finalization pipeline.
    validations:
      - type: graph_tool_used

  - id: 6079
    name: flask_check_reducibility_c
    category: TOOL_HAPPY_PATH
    description: >
      check_reducibility tool against Flask (test C). Target: blueprint subsystem.
    query: |
      Check reducibility of the blueprint registration and routing subsystem
    expected_state: COMPLETE
    reference_answer: |
      The blueprint registration subsystem has a largely reducible structure
      with linear registration flow, though nested blueprint support introduces
      recursive patterns that may create back edges in the control flow graph.
    validations:
      - type: graph_tool_used

  # -- Additional find_critical_path tests (80-81) -- expected_state: COMPLETE --

  - id: 6080
    name: flask_find_critical_path_b
    category: TOOL_HAPPY_PATH
    description: >
      find_critical_path tool against Flask (test B). Target: session lifecycle.
    query: |
      What is the critical path for session creation and persistence in Flask?
    expected_state: COMPLETE
    reference_answer: |
      The critical session path is RequestContext.push -> open_session ->
      SecureCookieSessionInterface.open_session -> (request handling) ->
      finalize_request -> save_session -> SecureCookieSessionInterface.save_session.
    validations:
      - type: graph_tool_used

  - id: 6081
    name: flask_find_critical_path_c
    category: TOOL_HAPPY_PATH
    description: >
      find_critical_path tool against Flask (test C). Target: application startup.
    query: |
      What is the critical path for Flask application initialization and first request?
    expected_state: COMPLETE
    reference_answer: |
      Flask.__init__ -> setup logging -> register default error handlers ->
      create url_map -> Flask.run -> werkzeug.run_simple -> first wsgi_app call ->
      ensure_sync -> full_dispatch_request.
    validations:
      - type: graph_tool_used

  # -- Additional find_module_api tests (82-83) -- expected_state: COMPLETE --

  - id: 6082
    name: flask_find_module_api_b
    category: TOOL_HAPPY_PATH
    description: >
      find_module_api tool against Flask (test B). Target: flask.blueprints module.
    query: |
      What is the public API of the flask.blueprints module?
    expected_state: COMPLETE
    reference_answer: |
      flask.blueprints exports the Blueprint class with methods like route,
      before_request, after_request, errorhandler, register, and
      app_template_filter for organizing modular Flask applications.
    validations:
      - type: graph_tool_used

  - id: 6083
    name: flask_find_module_api_c
    category: TOOL_HAPPY_PATH
    description: >
      find_module_api tool against Flask (test C). Target: flask.helpers module.
    query: |
      What is the public API of the flask.helpers module?
    expected_state: COMPLETE
    reference_answer: |
      flask.helpers exports url_for, redirect, flash, get_flashed_messages,
      send_file, send_from_directory, make_response, abort, and
      stream_with_context as the primary utility functions.
    validations:
      - type: graph_tool_used

  # -- Additional find_weighted_criticality tests (84-85) -- expected_state: COMPLETE --

  - id: 6084
    name: flask_find_weighted_criticality_b
    category: TOOL_HAPPY_PATH
    description: >
      find_weighted_criticality tool against Flask (test B). Target: top critical functions in app.py.
    query: |
      What are the most critical functions in app.py by weighted importance?
    expected_state: COMPLETE
    reference_answer: |
      In app.py, weighted criticality ranks wsgi_app, full_dispatch_request,
      dispatch_request, and make_response highest because they score high
      on PageRank, betweenness centrality, and in/out degree simultaneously.
    validations:
      - type: graph_tool_used

  - id: 6085
    name: flask_find_weighted_criticality_c
    category: TOOL_HAPPY_PATH
    description: >
      find_weighted_criticality tool against Flask (test C). Target: functions with high weighted criticality outside app.py.
    query: |
      Which functions outside of app.py have the highest weighted criticality?
    expected_state: COMPLETE
    reference_answer: |
      Outside app.py, high weighted criticality functions include
      Blueprint.register in blueprints.py, url_for in helpers.py,
      RequestContext.push in ctx.py, and open_session in sessions.py
      due to their cross-module bridging roles.
    validations:
      - type: graph_tool_used


  # ── IT-24 through IT-42: New tool tests ──

  - id: 6086
    name: flask_graph_overview
    category: TOOL_HAPPY_PATH
    description: >
      graph_overview tool against Flask web framework. Get overall graph statistics.
    query: |
      Give me an overview of this codebase's call graph
    expected_state: COMPLETE
    reference_answer: |
      The Flask web framework call graph contains WSGI routing and Jinja2
      spanning packages like Flask, Blueprint, request, response.
    validations:
      - type: graph_tool_used

  - id: 6087
    name: flask_graph_overview_b
    category: TOOL_HAPPY_PATH
    description: >
      graph_overview tool against Flask web framework (test B). Focus on graph density.
    query: |
      How dense is the call graph and what is the average connectivity?
    expected_state: COMPLETE
    reference_answer: |
      The graph has moderate density with most functions having 2-5 callees.
      Hotspot functions have significantly higher degree reflecting the
      core architecture of Flask web framework.
    validations:
      - type: graph_tool_used

  - id: 6088
    name: flask_graph_overview_c
    category: TOOL_HAPPY_PATH
    description: >
      graph_overview tool against Flask web framework (test C). Focus on package distribution.
    query: |
      How are functions distributed across packages in the call graph?
    expected_state: COMPLETE
    reference_answer: |
      Functions are distributed across Flask, Blueprint, request, response,
      with the core package containing the most edges due to
      orchestration responsibilities.
    validations:
      - type: graph_tool_used

  - id: 6089
    name: flask_explore_package
    category: TOOL_HAPPY_PATH
    description: >
      explore_package tool against Flask web framework. Explore flask package.
    query: |
      Explore the flask package and show its key types and functions
    expected_state: COMPLETE
    reference_answer: |
      The flask package contains Flask, Blueprint, request, g, session, current_app.
    validations:
      - type: graph_tool_used

  - id: 6090
    name: flask_explore_package_b
    category: TOOL_HAPPY_PATH
    description: >
      explore_package tool against Flask web framework (test B). Explore flask.testing.
    query: |
      Explore the flask.testing and show its key types and functions
    expected_state: COMPLETE
    reference_answer: |
      The flask.testing contains FlaskClient, test request context.
    validations:
      - type: graph_tool_used

  - id: 6091
    name: flask_explore_package_c
    category: TOOL_HAPPY_PATH
    description: >
      explore_package tool against Flask web framework (test C). Explore flask.views.
    query: |
      Explore the flask.views and show its key types and functions
    expected_state: COMPLETE
    reference_answer: |
      The flask.views contains View, MethodView class-based views.
    validations:
      - type: graph_tool_used

  - id: 6092
    name: flask_list_packages
    category: TOOL_HAPPY_PATH
    description: >
      list_packages tool against Flask web framework. List all packages.
    query: |
      List all packages in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Packages include flask, flask.testing, flask.views, flask.json, flask.logging, flask.cli.
    validations:
      - type: graph_tool_used

  - id: 6093
    name: flask_list_packages_b
    category: TOOL_HAPPY_PATH
    description: >
      list_packages tool against Flask web framework (test B). Focus on count.
    query: |
      How many packages does this codebase have?
    expected_state: COMPLETE
    reference_answer: |
      The codebase has multiple packages organized by concern,
      including flask, flask.testing, flask.views, flask.json, flask.logging, flask.cli.
    validations:
      - type: graph_tool_used

  - id: 6094
    name: flask_list_packages_c
    category: TOOL_HAPPY_PATH
    description: >
      list_packages tool against Flask web framework (test C). Focus on hierarchy.
    query: |
      Show the package hierarchy and how packages are organized
    expected_state: COMPLETE
    reference_answer: |
      Packages are organized by concern with flask, flask.testing, flask.views, flask.json, flask.logging, flask.cli
      as the main functional groupings.
    validations:
      - type: graph_tool_used

  - id: 6095
    name: flask_read
    category: TOOL_HAPPY_PATH
    description: >
      Read tool against Flask web framework.
    query: |
      Show me the contents of app.py
    expected_state: COMPLETE
    reference_answer: |
      Flask class and WSGI application
    validations:
      - type: graph_tool_used

  - id: 6096
    name: flask_read_b
    category: TOOL_HAPPY_PATH
    description: >
      Read tool against Flask web framework (test B).
    query: |
      Read the blueprints.py file
    expected_state: COMPLETE
    reference_answer: |
      Blueprint registration
    validations:
      - type: graph_tool_used

  - id: 6097
    name: flask_read_c
    category: TOOL_HAPPY_PATH
    description: >
      Read tool against Flask web framework (test C).
    query: |
      Show me the wrappers.py file
    expected_state: COMPLETE
    reference_answer: |
      Request/Response classes
    validations:
      - type: graph_tool_used

  - id: 6098
    name: flask_trace_request_dispatch
    category: TOOL_HAPPY_PATH
    description: >
      Trace the request dispatch flow in Flask.
    query: |
      What is the complete call chain from WSGI entry to route handler in Flask?
    expected_state: COMPLETE
    reference_answer: |
      Request dispatch flows through Flask.__call__, wsgi_app, request context
      push, URL rule matching via Map.match, and dispatch to the view function
      registered for that endpoint.
    validations:
      - type: graph_tool_used

  - id: 6099
    name: flask_trace_blueprint_registration
    category: TOOL_HAPPY_PATH
    description: >
      Trace blueprint registration flow in Flask.
    query: |
      How does Flask register blueprints and merge their routes?
    expected_state: COMPLETE
    reference_answer: |
      Blueprint registration flows through app.register_blueprint which
      calls Blueprint.register, applying URL prefix, deferred setup functions,
      and merging blueprint routes into the app's URL map.
    validations:
      - type: graph_tool_used

  - id: 6100
    name: flask_trace_error_handling
    category: TOOL_HAPPY_PATH
    description: >
      Trace error handler resolution in Flask.
    query: |
      Trace the call chain when an exception occurs during request handling
    expected_state: COMPLETE
    reference_answer: |
      Exception handling flows through handle_exception, which looks up
      registered error handlers by exception class, falls back to the
      default InternalServerError handler, and returns an error response.
    validations:
      - type: graph_tool_used

  - id: 6101
    name: flask_trace_context_lifecycle
    category: TOOL_HAPPY_PATH
    description: >
      Trace request and application context lifecycle in Flask.
    query: |
      What functions manage the request context push and pop lifecycle?
    expected_state: COMPLETE
    reference_answer: |
      Request context management involves RequestContext.push which sets up
      the context local stack, creates the request/session objects, and
      RequestContext.pop which tears down and runs teardown callbacks.
    validations:
      - type: graph_tool_used

  - id: 6102
    name: flask_trace_template_rendering
    category: TOOL_HAPPY_PATH
    description: >
      Trace template rendering flow in Flask.
    query: |
      How does render_template flow from Flask to Jinja2 output?
    expected_state: COMPLETE
    reference_answer: |
      render_template gets the Jinja2 environment, loads the template by name,
      updates the context with template globals, renders the template to
      a string, and signals template_rendered.
    validations:
      - type: graph_tool_used

  - id: 6103
    name: flask_trace_session_handling
    category: TOOL_HAPPY_PATH
    description: >
      Trace session handling in Flask.
    query: |
      What is the call path for session creation and cookie signing in Flask?
    expected_state: COMPLETE
    reference_answer: |
      Session handling flows through SecureCookieSessionInterface which opens
      the session by decoding the signed cookie, makes it available as
      flask.session, and saves it back with itsdangerous signing on response.
    validations:
      - type: graph_tool_used

  - id: 6104
    name: flask_glob
    category: TOOL_HAPPY_PATH
    description: >
      Glob tool against Flask web framework.
    query: |
      Find all files matching *.py in flask/
    expected_state: COMPLETE
    reference_answer: |
      The Glob tool processes *.py in flask/ for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6105
    name: flask_glob_b
    category: TOOL_HAPPY_PATH
    description: >
      Glob tool against Flask web framework (test B).
    query: |
      Find files matching tests/*.py
    expected_state: COMPLETE
    reference_answer: |
      The Glob tool processes tests/*.py for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6106
    name: flask_glob_c
    category: TOOL_HAPPY_PATH
    description: >
      Glob tool against Flask web framework (test C).
    query: |
      Search for flask/json/*.py files
    expected_state: COMPLETE
    reference_answer: |
      The Glob tool processes flask/json/*.py for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6107
    name: flask_grep
    category: TOOL_HAPPY_PATH
    description: >
      Grep tool against Flask web framework.
    query: |
      Search for @route decorator usage in the codebase
    expected_state: COMPLETE
    reference_answer: |
      The Grep tool processes @route decorator usage for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6108
    name: flask_grep_b
    category: TOOL_HAPPY_PATH
    description: >
      Grep tool against Flask web framework (test B).
    query: |
      Find all before_request hooks
    expected_state: COMPLETE
    reference_answer: |
      The Grep tool processes before_request hooks for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6109
    name: flask_grep_c
    category: TOOL_HAPPY_PATH
    description: >
      Grep tool against Flask web framework (test C).
    query: |
      Search for errorhandler registration
    expected_state: COMPLETE
    reference_answer: |
      The Grep tool processes errorhandler registration for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6110
    name: flask_diff
    category: TOOL_HAPPY_PATH
    description: >
      Diff tool against Flask web framework.
    query: |
      Compare Flask vs Blueprint
    expected_state: COMPLETE
    reference_answer: |
      The Diff tool processes Flask vs Blueprint for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6111
    name: flask_diff_b
    category: TOOL_HAPPY_PATH
    description: >
      Diff tool against Flask web framework (test B).
    query: |
      Show differences between Request vs Response wrappers
    expected_state: COMPLETE
    reference_answer: |
      The Diff tool processes Request vs Response wrappers for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6112
    name: flask_diff_c
    category: TOOL_HAPPY_PATH
    description: >
      Diff tool against Flask web framework (test C).
    query: |
      Compare sync vs async views
    expected_state: COMPLETE
    reference_answer: |
      The Diff tool processes sync vs async views for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6113
    name: flask_tree
    category: TOOL_HAPPY_PATH
    description: >
      Tree tool against Flask web framework.
    query: |
      Show the flask package structure
    expected_state: COMPLETE
    reference_answer: |
      The Tree tool processes flask package structure for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6114
    name: flask_tree_b
    category: TOOL_HAPPY_PATH
    description: >
      Tree tool against Flask web framework (test B).
    query: |
      Show the tests directory structure
    expected_state: COMPLETE
    reference_answer: |
      The Tree tool processes tests directory for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6115
    name: flask_tree_c
    category: TOOL_HAPPY_PATH
    description: >
      Tree tool against Flask web framework (test C).
    query: |
      Display the examples directory layout
    expected_state: COMPLETE
    reference_answer: |
      The Tree tool processes examples directory for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6116
    name: flask_trace_url_routing
    category: TOOL_HAPPY_PATH
    description: >
      Trace URL rule matching in Flask.
    query: |
      How does Flask match an incoming URL to a registered route?
    expected_state: COMPLETE
    reference_answer: |
      URL matching uses Werkzeug's Map and Rule system. The URL adapter
      matches the path against compiled regex rules, extracts path
      parameters, and returns the endpoint and argument values.
    validations:
      - type: graph_tool_used

  - id: 6117
    name: flask_trace_signal_dispatch
    category: TOOL_HAPPY_PATH
    description: >
      Trace signal dispatch in Flask.
    query: |
      What functions are called when Flask dispatches the request_started signal?
    expected_state: COMPLETE
    reference_answer: |
      Signal dispatch uses Blinker. request_started.send triggers all
      connected receivers with the app as sender, allowing extensions
      to hook into the request lifecycle without subclassing.
    validations:
      - type: graph_tool_used

  - id: 6118
    name: flask_trace_response_build
    category: TOOL_HAPPY_PATH
    description: >
      Trace response object construction in Flask.
    query: |
      How does Flask construct a Response from a view function's return value?
    expected_state: COMPLETE
    reference_answer: |
      Response construction flows through make_response which handles
      string, tuple, and Response return types, applies after_request
      handlers, sets cookies/headers, and returns a WSGI-compatible Response.
    validations:
      - type: graph_tool_used

  - id: 6119
    name: flask_validate_syntax
    category: TOOL_HAPPY_PATH
    description: >
      validate_syntax tool against Flask web framework.
    query: |
      Validate the syntax of app.py
    expected_state: COMPLETE
    reference_answer: |
      The validate_syntax tool processes app.py for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6120
    name: flask_validate_syntax_b
    category: TOOL_HAPPY_PATH
    description: >
      validate_syntax tool against Flask web framework (test B).
    query: |
      Check the syntax of blueprints.py
    expected_state: COMPLETE
    reference_answer: |
      The validate_syntax tool processes blueprints.py for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6121
    name: flask_validate_syntax_c
    category: TOOL_HAPPY_PATH
    description: >
      validate_syntax tool against Flask web framework (test C).
    query: |
      Verify the syntax of ctx.py
    expected_state: COMPLETE
    reference_answer: |
      The validate_syntax tool processes ctx.py for
      the Flask web framework codebase.
    validations:
      - type: graph_tool_used

  - id: 6122
    name: flask_find_entry_points_b
    category: TOOL_HAPPY_PATH
    description: >
      find_entry_points tool against Flask web framework (test B). Focus on WSGI entry.
    query: |
      WSGI entry
    expected_state: COMPLETE
    reference_answer: |
      Flask.__call__, Flask.wsgi_app, Flask.run
    validations:
      - type: graph_tool_used

  - id: 6123
    name: flask_find_entry_points_c
    category: TOOL_HAPPY_PATH
    description: >
      find_entry_points tool against Flask web framework (test C). Focus on CLI entry.
    query: |
      CLI entry
    expected_state: COMPLETE
    reference_answer: |
      flask.cli, FlaskGroup, run_command
    validations:
      - type: graph_tool_used

  - id: 6124
    name: flask_trace_data_flow_b
    category: TOOL_HAPPY_PATH
    description: >
      trace_data_flow tool against Flask web framework (test B). Focus on request lifecycle.
    query: |
      request lifecycle in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      wsgi_app, request_context, dispatch_request
    validations:
      - type: graph_tool_used

  - id: 6125
    name: flask_trace_data_flow_c
    category: TOOL_HAPPY_PATH
    description: >
      trace_data_flow tool against Flask web framework (test C). Focus on response building.
    query: |
      response building in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      make_response, process_response, after_request hooks
    validations:
      - type: graph_tool_used

  - id: 6126
    name: flask_trace_error_flow_b
    category: TOOL_HAPPY_PATH
    description: >
      trace_error_flow tool against Flask web framework (test B). Focus on HTTP error handling.
    query: |
      HTTP error handling
    expected_state: COMPLETE
    reference_answer: |
      abort(), HTTPException, errorhandler
    validations:
      - type: graph_tool_used

  - id: 6127
    name: flask_trace_error_flow_c
    category: TOOL_HAPPY_PATH
    description: >
      trace_error_flow tool against Flask web framework (test C). Focus on unhandled exceptions.
    query: |
      unhandled exceptions in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      handle_exception, InternalServerError, 500 response
    validations:
      - type: graph_tool_used

  - id: 6128
    name: flask_build_minimal_context_b
    category: TOOL_HAPPY_PATH
    description: >
      build_minimal_context tool against Flask web framework (test B). Focus on request dispatch.
    query: |
      request dispatch in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      full_dispatch_request, url_map, Rule, endpoint
    validations:
      - type: graph_tool_used

  - id: 6129
    name: flask_build_minimal_context_c
    category: TOOL_HAPPY_PATH
    description: >
      build_minimal_context tool against Flask web framework (test C). Focus on app context.
    query: |
      app context in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      AppContext, RequestContext, _app_ctx_stack, g object
    validations:
      - type: graph_tool_used

  - id: 6130
    name: flask_find_similar_code_b
    category: TOOL_HAPPY_PATH
    description: >
      find_similar_code tool against Flask web framework (test B). Focus on hook decorators.
    query: |
      hook decorators in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      before_request, after_request, teardown similar patterns
    validations:
      - type: graph_tool_used

  - id: 6131
    name: flask_find_similar_code_c
    category: TOOL_HAPPY_PATH
    description: >
      find_similar_code tool against Flask web framework (test C). Focus on Blueprint vs Flask.
    query: |
      Blueprint vs Flask
    expected_state: COMPLETE
    reference_answer: |
      similar route registration, error handling, template methods
    validations:
      - type: graph_tool_used

  - id: 6132
    name: flask_find_config_usage_b
    category: TOOL_HAPPY_PATH
    description: >
      find_config_usage tool against Flask web framework (test B). Focus on app.config.
    query: |
      app.config in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      SECRET_KEY, DEBUG, TESTING, database URLs
    validations:
      - type: graph_tool_used

  - id: 6133
    name: flask_find_config_usage_c
    category: TOOL_HAPPY_PATH
    description: >
      find_config_usage tool against Flask web framework (test C). Focus on template config.
    query: |
      template config in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      TEMPLATES_AUTO_RELOAD, template_folder, Jinja env
    validations:
      - type: graph_tool_used

  - id: 6134
    name: flask_summarize_file_b
    category: TOOL_HAPPY_PATH
    description: >
      summarize_file tool against Flask web framework (test B). Focus on ctx.py.
    query: |
      ctx.py in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      RequestContext, AppContext, context stack management
    validations:
      - type: graph_tool_used

  - id: 6135
    name: flask_summarize_file_c
    category: TOOL_HAPPY_PATH
    description: >
      summarize_file tool against Flask web framework (test C). Focus on blueprints.py.
    query: |
      blueprints.py in Flask web framework?
    expected_state: COMPLETE
    reference_answer: |
      Blueprint class, deferred registration, url_prefix
    validations:
      - type: graph_tool_used

  # -- GR-58: CRS TraceStep Verification Tests --

  - id: 6136
    name: flask_crs_find_callers
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58: Verify find_callers produces CRS TraceStep. Target: full_dispatch_request.
    query: |
      Who calls the full_dispatch_request function?
    expected_state: COMPLETE
    reference_answer: |
      find_callers tool was used and produced a CRS TraceStep recording the query
      for full_dispatch_request with match_count, total_callers, and used_inheritance_path metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6137
    name: flask_crs_find_callees
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58: Verify find_callees produces CRS TraceStep. Target: make_response.
    query: |
      What functions does make_response call?
    expected_state: COMPLETE
    reference_answer: |
      find_callees tool was used and produced a CRS TraceStep recording the query
      for make_response with resolved_count, external_count, and total_count metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  # -- GR-58: CRS TraceStep Verification (IT-03 to IT-42) --

  - id: 6138
    name: flask_crs_find_references
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-06: Verify find_references produces CRS TraceStep against Flask.
    query: |
      Find all references to the Flask class in the codebase.
    expected_state: COMPLETE
    reference_answer: |
      find_references tool was used and produced a CRS TraceStep with
      reference_count and symbol_matches metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6139
    name: flask_crs_find_communities
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-11: Verify find_communities produces CRS TraceStep against Flask.
    query: |
      Find module communities or clusters in Flask's codebase.
    expected_state: COMPLETE
    reference_answer: |
      find_communities tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6140
    name: flask_crs_find_merge_points
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-15: Verify find_merge_points produces CRS TraceStep against Flask.
    query: |
      Find merge points in Flask's request handling flow.
    expected_state: COMPLETE
    reference_answer: |
      find_merge_points tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6141
    name: flask_crs_find_critical_path
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-20: Verify find_critical_path produces CRS TraceStep against Flask.
    query: |
      Find the critical path from Flask's entry point.
    expected_state: COMPLETE
    reference_answer: |
      find_critical_path tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6142
    name: flask_crs_graph_overview
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-24: Verify graph_overview produces CRS TraceStep against Flask.
    query: |
      Give an overview of Flask's codebase graph structure.
    expected_state: COMPLETE
    reference_answer: |
      graph_overview tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6143
    name: flask_crs_trace_data_flow
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-29: Verify trace_data_flow produces CRS TraceStep against Flask.
    query: |
      Trace the data flow for the request object in Flask.
    expected_state: COMPLETE
    reference_answer: |
      trace_data_flow tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6144
    name: flask_crs_find_config_usage
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-33: Verify find_config_usage produces CRS TraceStep against Flask.
    query: |
      Find configuration usage patterns in Flask.
    expected_state: COMPLETE
    reference_answer: |
      find_config_usage tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6145
    name: flask_crs_grep
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-38: Verify grep tool produces CRS TraceStep against Flask.
    query: |
      Search for error handling patterns in Flask's source code.
    expected_state: COMPLETE
    reference_answer: |
      grep tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6146
    name: flask_crs_validate_syntax
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-42: Verify validate_syntax produces CRS TraceStep against Flask.
    query: |
      Validate the syntax of Flask's app.py file.
    expected_state: COMPLETE
    reference_answer: |
      validate_syntax tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  # -- IT-01/IT-02/IT-03: Second CRS TraceStep Verification --

  - id: 6147
    name: flask_crs_find_callers_b
    category: TOOL_CRS_VERIFICATION
    description: >
      IT-01: Second CRS verification for find_callers against Flask. Target: Flask.dispatch_request.
    query: |
      Who calls the Flask.dispatch_request method in Flask?
    expected_state: COMPLETE
    reference_answer: |
      find_callers tool was used and produced a CRS TraceStep with
      match_count, total_callers, and used_inheritance_path metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6148
    name: flask_crs_find_callees_b
    category: TOOL_CRS_VERIFICATION
    description: >
      IT-02: Second CRS verification for find_callees against Flask. Target: Flask.full_dispatch_request.
    query: |
      What functions does Flask.full_dispatch_request call in Flask?
    expected_state: COMPLETE
    reference_answer: |
      find_callees tool was used and produced a CRS TraceStep with
      resolved_count, external_count, and total_count metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6149
    name: flask_crs_find_implementations_a
    category: TOOL_CRS_VERIFICATION
    description: >
      IT-03: First CRS verification for find_implementations against Flask. Target: SessionInterface.
    query: |
      What classes implement the SessionInterface in Flask?
    expected_state: COMPLETE
    reference_answer: |
      find_implementations tool was used and produced a CRS TraceStep with
      match_count, total_implementations, and index_used metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 6150
    name: flask_crs_find_implementations_b
    category: TOOL_CRS_VERIFICATION
    description: >
      IT-03: Second CRS verification for find_implementations against Flask. Target: Response.
    query: |
      What classes extend the Response class in Flask?
    expected_state: COMPLETE
    reference_answer: |
      find_implementations tool was used and produced a CRS TraceStep with
      match_count, total_implementations, and index_used metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present
