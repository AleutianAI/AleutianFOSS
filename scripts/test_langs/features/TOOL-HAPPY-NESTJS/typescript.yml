# TOOL-HAPPY-NESTJS: Tool Happy Path Tests (TypeScript - NestJS)
#
# One happy-path test per registered tool against the NestJS framework.
# Tests 8000-8022: Registered tools (expected_state: COMPLETE)
# Tests 8023-8039: Unregistered/TODO tools (expected_state: COMPLETE)

metadata:
  feature: TOOL-HAPPY-NESTJS
  title: "Tool Happy Path - NestJS"
  language: typescript
  project: nestjs
  project_root: ~/projects/crs_test_codebases/typescript/nestjs
  ticket: tickets/in_progress/integration_testing_outcomes_results_1a.md
  description: >
    Validates every registered graph tool against the NestJS framework.
    NestJS is a TypeScript framework for building server-side applications
    with decorators and dependency injection.

tests:
  # ── Registered Tools (00-22) ── expected_state: COMPLETE ──

  - id: 8000
    name: nestjs_find_callers
    category: TOOL_HAPPY_PATH
    description: >
      find_callers tool against NestJS. Target: MetadataScanner.getAllMethodNames method.
    query: |
      Who calls the MetadataScanner.getAllMethodNames method?
    expected_state: COMPLETE
    reference_answer: |
      MetadataScanner.getAllMethodNames is called by 7 callers:
      PathsExplorer.explore, GatewayMetadataExplorer.explore,
      InstanceMetadataFactory.create, reflectParamInjectables,
      ListenerMetadataExplorer.explore, MethodsReplFn.action,
      and getAllFilteredMethodNames. These are spread across the core
      and microservices packages for scanning controller/provider methods.
    validations:
      - type: graph_tool_used

  - id: 8001
    name: nestjs_find_callees
    category: TOOL_HAPPY_PATH
    description: >
      find_callees tool against NestJS. Target: NestApplication.listen method.
    query: |
      What functions does NestApplication.listen call?
    expected_state: COMPLETE
    reference_answer: |
      NestApplication.listen calls HTTP adapter listen, runs lifecycle hooks
      including onModuleInit and onApplicationBootstrap, and logs the listening address.
    validations:
      - type: graph_tool_used

  - id: 8002
    name: nestjs_find_implementations
    category: TOOL_HAPPY_PATH
    description: >
      find_implementations tool against NestJS. Target: NestInterceptor interface.
    query: |
      What classes implement the NestInterceptor interface?
    expected_state: COMPLETE
    reference_answer: |
      NestInterceptor implementations include built-in interceptors for
      logging, caching, and timeout handling across the framework.
    validations:
      - type: graph_tool_used

  - id: 8003
    name: nestjs_find_symbol
    category: TOOL_HAPPY_PATH
    description: >
      find_symbol tool against NestJS. Target: NestFactory class.
    query: |
      Where is the NestFactory class defined?
    expected_state: COMPLETE
    reference_answer: |
      NestFactory is defined in packages/core/nest-factory.ts. It is the
      main entry point for creating NestJS application instances.
    validations:
      - type: graph_tool_used

  - id: 8004
    name: nestjs_find_references
    category: TOOL_HAPPY_PATH
    description: >
      find_references tool against NestJS. Target: Injectable decorator.
    query: |
      Where is the Injectable decorator used across the codebase?
    expected_state: COMPLETE
    reference_answer: |
      The Injectable decorator is used extensively across packages/core and
      packages/common to mark classes for dependency injection resolution.
    validations:
      - type: graph_tool_used

  - id: 8005
    name: nestjs_get_call_chain
    category: TOOL_HAPPY_PATH
    description: >
      get_call_chain tool against NestJS. From NestFactory.create to module initialization.
    query: |
      Show the call chain from NestFactory.create to module initialization
    expected_state: COMPLETE
    reference_answer: |
      NestFactory.create -> NestApplication constructor -> DependenciesScanner.scan ->
      InstanceLoader.createInstances -> module initialization and provider resolution.
    validations:
      - type: graph_tool_used

  - id: 8006
    name: nestjs_find_path
    category: TOOL_HAPPY_PATH
    description: >
      find_path tool against NestJS. Between NestApplication.init and controller registration.
    query: |
      Find the shortest path between NestApplication.init and controller registration
    expected_state: COMPLETE
    reference_answer: |
      NestApplication.init -> RoutesResolver.resolve -> RouterExplorer.explore ->
      controller method registration on the underlying HTTP adapter.
    validations:
      - type: graph_tool_used

  - id: 8007
    name: nestjs_find_hotspots
    category: TOOL_HAPPY_PATH
    description: >
      find_hotspots tool against NestJS.
    query: |
      What are the most connected functions (hotspots) in this codebase?
    expected_state: COMPLETE
    reference_answer: |
      Top hotspots include functions in the dependency injection container,
      the module compiler, and the routes resolver handling request routing.
    validations:
      - type: graph_tool_used

  - id: 8008
    name: nestjs_find_dead_code
    category: TOOL_HAPPY_PATH
    description: >
      find_dead_code tool against NestJS.
    query: |
      Find unused or dead code in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Dead code analysis finds functions with zero incoming edges that are
      not entry points, decorators, or lifecycle hook implementations.
    validations:
      - type: graph_tool_used

  - id: 8009
    name: nestjs_find_cycles
    category: TOOL_HAPPY_PATH
    description: >
      find_cycles tool against NestJS.
    query: |
      Find circular call dependencies in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Found 11 circular dependency cycles. The largest cycle has 22 nodes spanning
      the dependency injection system: reflectCatchExceptions -> getFilterInstance
      -> createConcreteContext -> exchangeKeysForValues -> instance ->
      setInstanceByContextId -> cloneStaticInstance -> setInstanceByInquirerId
      -> getStaticModuleToken -> getModuleId -> create -> cloneTransientInstance,
      across packages/core/exceptions/, packages/core/helpers/, packages/core/injector/.
    validations:
      - type: graph_tool_used

  - id: 8010
    name: nestjs_find_important
    category: TOOL_HAPPY_PATH
    description: >
      find_important tool (PageRank) against NestJS.
    query: |
      What are the most important functions by PageRank in this codebase?
    expected_state: COMPLETE
    reference_answer: |
      PageRank identifies central functions in the Injector (dependency resolution),
      NestApplication (lifecycle), and RoutesResolver (request handling).
    validations:
      - type: graph_tool_used

  - id: 8011
    name: nestjs_find_communities
    category: TOOL_HAPPY_PATH
    description: >
      find_communities tool (Leiden) against NestJS.
    query: |
      Find natural code communities and module boundaries in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Communities align with NestJS package structure: core (DI container),
      common (decorators/pipes), platform-express, platform-fastify, microservices.
    validations:
      - type: graph_tool_used

  - id: 8012
    name: nestjs_find_articulation_points
    category: TOOL_HAPPY_PATH
    description: >
      find_articulation_points tool against NestJS.
    query: |
      Find single points of failure in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Articulation points include key orchestration functions in the Injector
      that bridge between module scanning, instance creation, and provider resolution.
    validations:
      - type: graph_tool_used

  - id: 8013
    name: nestjs_find_dominators
    category: TOOL_HAPPY_PATH
    description: >
      find_dominators tool against NestJS. Target: controller handler execution.
    query: |
      What functions must be called before a controller handler executes?
    expected_state: COMPLETE
    reference_answer: |
      Dominators of handler execution include RoutesResolver.resolve,
      RouterExplorer.explore, and middleware/guard/interceptor pipeline setup.
    validations:
      - type: graph_tool_used

  - id: 8014
    name: nestjs_find_loops
    category: TOOL_HAPPY_PATH
    description: >
      find_loops tool against NestJS. Target: dependency injection container.
    query: |
      Find recursive functions in the dependency injection container
    expected_state: COMPLETE
    reference_answer: |
      Recursive patterns exist in the Injector for resolving nested dependencies,
      scanning module imports, and traversing provider dependency trees.
    validations:
      - type: graph_tool_used

  - id: 8015
    name: nestjs_find_merge_points
    category: TOOL_HAPPY_PATH
    description: >
      find_merge_points tool against NestJS. Target: middleware pipelines.
    query: |
      Where do different middleware pipelines converge?
    expected_state: COMPLETE
    reference_answer: |
      Merge points include the request handler execution where guards,
      interceptors, and pipes converge before the controller method runs.
    validations:
      - type: graph_tool_used

  - id: 8016
    name: nestjs_find_common_dependency
    category: TOOL_HAPPY_PATH
    description: >
      find_common_dependency tool against NestJS. Target: Guards and Interceptors.
    query: |
      What shared dependency do Guards and Interceptors have?
    expected_state: COMPLETE
    reference_answer: |
      Both Guards and Interceptors depend on the ExecutionContext and
      the Reflector for reading metadata set by decorators.
    validations:
      - type: graph_tool_used

  - id: 8017
    name: nestjs_find_control_dependencies
    category: TOOL_HAPPY_PATH
    description: >
      find_control_dependencies tool against NestJS. Target: pipe transformation.
    query: |
      What conditionals control whether a pipe transformation runs?
    expected_state: COMPLETE
    reference_answer: |
      Pipe execution is controlled by parameter decorator metadata,
      the UsePipes decorator presence, and global pipe configuration.
    validations:
      - type: graph_tool_used

  - id: 8018
    name: nestjs_find_extractable_regions
    category: TOOL_HAPPY_PATH
    description: >
      find_extractable_regions tool against NestJS.
    query: |
      Find functions that could be safely extracted into separate functions
    expected_state: COMPLETE
    reference_answer: |
      SESE regions in large functions like Injector.loadProvider and
      RoutesResolver.resolve that have clear entry/exit points for extraction.
    validations:
      - type: graph_tool_used

  - id: 8019
    name: nestjs_check_reducibility
    category: TOOL_HAPPY_PATH
    description: >
      check_reducibility tool against NestJS.
    query: |
      Check the control flow structure quality of this codebase
    expected_state: COMPLETE
    reference_answer: |
      Reducibility analysis shows the overall control flow graph structure,
      identifying any irreducible regions that complicate analysis.
    validations:
      - type: graph_tool_used

  - id: 8020
    name: nestjs_find_critical_path
    category: TOOL_HAPPY_PATH
    description: >
      find_critical_path tool against NestJS.
    query: |
      What is the mandatory call sequence to handle an incoming HTTP request?
    expected_state: COMPLETE
    reference_answer: |
      The critical path goes through middleware -> guards -> interceptors ->
      pipes -> controller handler, representing the mandatory execution sequence.
    validations:
      - type: graph_tool_used

  - id: 8021
    name: nestjs_find_module_api
    category: TOOL_HAPPY_PATH
    description: >
      find_module_api tool against NestJS. Target: core package.
    query: |
      What is the public API of the core package?
    expected_state: COMPLETE
    reference_answer: |
      The core package exports NestFactory, NestApplication, Injector,
      and related types for creating and managing NestJS applications.
    validations:
      - type: graph_tool_used

  - id: 8022
    name: nestjs_find_weighted_criticality
    category: TOOL_HAPPY_PATH
    description: >
      find_weighted_criticality tool against NestJS.
    query: |
      What are the most critical functions by weighted importance?
    expected_state: COMPLETE
    reference_answer: |
      Weighted criticality combines PageRank, betweenness, and degree
      centrality to identify functions critical across multiple dimensions.
    validations:
      - type: graph_tool_used

  # ── Unregistered/TODO Tools (23-39) ── expected_state: COMPLETE ──

  - id: 8023
    name: nestjs_find_entry_points
    category: TOOL_HAPPY_PATH
    description: >
      find_entry_points tool against NestJS. Find execution entry points.
    query: |
      What are the entry points into this codebase?
    expected_state: COMPLETE
    reference_answer: |
      Entry points include NestFactory.create() for application
      bootstrap, module initializers, and the HTTP adapter that
      starts listening for incoming requests.
    validations:
      - type: graph_tool_used

  - id: 8024
    name: nestjs_trace_data_flow
    category: TOOL_HAPPY_PATH
    description: >
      trace_data_flow tool against NestJS. Trace request data flow.
    query: |
      Trace how request data flows through the middleware pipeline
    expected_state: COMPLETE
    reference_answer: |
      Request data flows through middleware, guards, interceptors,
      pipes (for validation/transformation), then to the controller
      handler, and back through interceptors for response mapping.
    validations:
      - type: graph_tool_used

  - id: 8025
    name: nestjs_trace_error_flow
    category: TOOL_HAPPY_PATH
    description: >
      trace_error_flow tool against NestJS. Trace exception filters.
    query: |
      Trace how errors propagate through the exception filter system
    expected_state: COMPLETE
    reference_answer: |
      Exceptions propagate from handlers through the exception zone,
      caught by ExceptionFilters (custom or BaseExceptionFilter),
      which transform them into HTTP responses with status codes.
    validations:
      - type: graph_tool_used

  - id: 8026
    name: nestjs_find_config_usage
    category: TOOL_HAPPY_PATH
    description: >
      find_config_usage tool against NestJS. Find module metadata usage.
    query: |
      How is the module metadata configuration used across NestJS?
    expected_state: COMPLETE
    reference_answer: |
      Module metadata from @Module decorators is read by
      DependenciesScanner to build the module tree, resolve providers,
      and wire up the DI container during application bootstrap.
    validations:
      - type: graph_tool_used

  - id: 8027
    name: nestjs_find_similar_code
    category: TOOL_HAPPY_PATH
    description: >
      find_similar_code tool against NestJS. Similar to guard execution.
    query: |
      Find code similar to the guard execution logic
    expected_state: COMPLETE
    reference_answer: |
      Code similar to guard execution exists in interceptor binding,
      pipe execution, and filter binding — all following the pattern
      of metadata reflection, instance resolution, and sequential execution.
    validations:
      - type: graph_tool_used

  - id: 8028
    name: nestjs_build_minimal_context
    category: TOOL_HAPPY_PATH
    description: >
      build_minimal_context tool against NestJS. Context for Injector.
    query: |
      Build minimal context needed to understand the Injector class
    expected_state: COMPLETE
    reference_answer: |
      Minimal context includes NestContainer, Module, InstanceWrapper,
      provider tokens, inject metadata, and the resolution algorithm
      that handles circular dependencies and scoping.
    validations:
      - type: graph_tool_used

  - id: 8029
    name: nestjs_summarize_file
    category: TOOL_HAPPY_PATH
    description: >
      summarize_file tool against NestJS. Summarize nest-factory.ts.
    query: |
      Summarize the packages/core/nest-factory.ts file
    expected_state: COMPLETE
    reference_answer: |
      nest-factory.ts defines NestFactory with the static create()
      method that bootstraps a NestApplication by scanning modules,
      resolving dependencies, and initializing the HTTP adapter.
    validations:
      - type: graph_tool_used

  - id: 8030
    name: nestjs_summarize_package
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: summarize_package tool (not yet registered as standalone tool).
    query: |
      Summarize the packages/common package and its submodules
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 8031
    name: nestjs_analyze_change_impact
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: analyze_change_impact tool (not yet registered as standalone tool).
    query: |
      What would be the impact of changing the NestInterceptor interface?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 8032
    name: nestjs_check_breaking_changes
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: check_breaking_changes tool (not yet registered as standalone tool).
    query: |
      Would removing the forwardRef function be a breaking change?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 8033
    name: nestjs_simulate_change
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: simulate_change tool (not yet registered as standalone tool).
    query: |
      Simulate the impact of refactoring the Injector into smaller classes
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 8034
    name: nestjs_find_test_coverage
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: find_test_coverage tool (not yet registered as standalone tool).
    query: |
      Which functions in packages/core lack test coverage?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 8035
    name: nestjs_detect_side_effects
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: detect_side_effects tool (not yet registered as standalone tool).
    query: |
      What side effects does the NestFactory.create method have?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 8036
    name: nestjs_detect_patterns
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: detect_patterns tool (not yet registered as standalone tool).
    query: |
      What design patterns are used in this codebase?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 8037
    name: nestjs_find_code_smells
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: find_code_smells tool (not yet registered as standalone tool).
    query: |
      Find code smells in this codebase
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 8038
    name: nestjs_find_duplication
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: find_duplication tool (not yet registered as standalone tool).
    query: |
      Find duplicated code patterns in this codebase
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  - id: 8039
    name: nestjs_extract_conventions
    category: TOOL_HAPPY_PATH_TODO
    description: >
      TODO: extract_conventions tool (not yet registered as standalone tool).
    query: |
      What coding conventions does this codebase follow?
    expected_state: COMPLETE
    reference_answer: |
      TODO: Tool not yet registered as standalone.
    validations: []

  # -- Additional find_callers tests (40-41) -- expected_state: COMPLETE --

  - id: 8040
    name: nestjs_find_callers_b
    category: TOOL_HAPPY_PATH
    description: >
      find_callers tool against NestJS (test B). Target: MetadataScanner.scanFromPrototype method.
    query: |
      Who calls the MetadataScanner.scanFromPrototype method?
    expected_state: COMPLETE
    reference_answer: |
      MetadataScanner.scanFromPrototype has 1+ callers including internal
      scanner utilities and test suites. It is the lower-level method that
      getAllMethodNames delegates to for walking the prototype chain and
      collecting method names from a given class.
    validations:
      - type: graph_tool_used

  - id: 8041
    name: nestjs_find_callers_c
    category: TOOL_HAPPY_PATH
    description: >
      find_callers tool against NestJS (test C). Target: isFunction utility.
    query: |
      Who calls the isFunction utility?
    expected_state: COMPLETE
    reference_answer: |
      isFunction has 80+ callers spread across the entire NestJS framework.
      It is a core type-checking utility in packages/common/utils/shared.utils.ts
      used pervasively for parameter validation, decorator processing,
      provider resolution, and lifecycle hook detection throughout packages/core,
      packages/common, packages/microservices, and packages/websockets.
    validations:
      - type: graph_tool_used
  # -- Additional find_implementations tests (44-45) -- expected_state: COMPLETE --
  - id: 8044
    name: nestjs_find_implementations_b
    category: TOOL_HAPPY_PATH
    description: >
      find_implementations tool against NestJS (test B). Target: CanActivate interface (guards).
    query: |
      What classes implement the CanActivate interface to serve as route guards?
    expected_state: COMPLETE
    reference_answer: |
      CanActivate in packages/common/interfaces/features/can-activate.interface.ts
      is implemented by guard classes including AuthGuard and ThrottlerGuard
      that control access to route handlers based on authentication and rate limiting.
    validations:
      - type: graph_tool_used

  - id: 8045
    name: nestjs_find_implementations_c
    category: TOOL_HAPPY_PATH
    description: >
      find_implementations tool against NestJS (test C). Target: PipeTransform interface (pipes).
    query: |
      What classes implement the PipeTransform interface for NestJS pipes?
    expected_state: COMPLETE
    reference_answer: |
      PipeTransform in packages/common/interfaces/features/pipe-transform.interface.ts
      is implemented by ValidationPipe, ParseIntPipe, ParseBoolPipe, ParseArrayPipe,
      ParseUUIDPipe, ParseEnumPipe, ParseFloatPipe, and DefaultValuePipe
      in packages/common/pipes/.
    validations:
      - type: graph_tool_used

  # -- Additional find_callees tests (42-43) -- expected_state: COMPLETE --
  - id: 8042
    name: nestjs_find_callees_b
    category: TOOL_HAPPY_PATH
    description: >
      find_callees tool against NestJS (test B). Target: NestFactory.create method.

    query: |
      What functions does NestFactory.create call?
    expected_state: COMPLETE
    reference_answer: |
      NestFactory.create calls createHttpAdapter, creates new ApplicationConfig
      and NestContainer instances, calls createGraphInspector,
      setAbortOnError, registerLoggerConfiguration, and initialize
      to bootstrap the application, then creates a new NestApplication.
    validations:
      - type: graph_tool_used

  - id: 8043
    name: nestjs_find_callees_c
    category: TOOL_HAPPY_PATH
    description: >
      find_callees tool against NestJS (test C). Target: NestApplication.registerModules method.

    query: |
      What functions does NestApplication.registerModules call?
    expected_state: COMPLETE
    reference_answer: |
      NestApplication.registerModules calls registerWsModule for WebSocket setup,
      microservicesModule.register and microservicesModule.setupClients for
      microservice integration, and middlewareModule.register to initialize
      the middleware pipeline.
    validations:
      - type: graph_tool_used

  # -- Additional find_symbol tests (46-47) -- expected_state: COMPLETE --

  - id: 8046
    name: nestjs_find_symbol_b
    category: TOOL_HAPPY_PATH
    description: >
      find_symbol tool against NestJS (test B). Target: Injector class.
    query: |
      Where is the Injector class defined?
    expected_state: COMPLETE
    reference_answer: |
      Injector is defined in packages/core/injector/injector.ts. It is the
      core dependency injection engine responsible for resolving and instantiating
      providers within the NestJS container.
    validations:
      - type: graph_tool_used

  - id: 8047
    name: nestjs_find_symbol_c
    category: TOOL_HAPPY_PATH
    description: >
      find_symbol tool against NestJS (test C). Target: RoutesResolver class.
    query: |
      Where is the RoutesResolver class defined?
    expected_state: COMPLETE
    reference_answer: |
      RoutesResolver is defined in packages/core/router/routes-resolver.ts.
      It scans all registered controllers and delegates to RouterExplorer
      to bind route handlers to the underlying HTTP adapter.
    validations:
      - type: graph_tool_used

  # -- Additional find_references tests (48-49) -- expected_state: COMPLETE --

  - id: 8048
    name: nestjs_find_references_b
    category: TOOL_HAPPY_PATH
    description: >
      find_references tool against NestJS (test B). Target: ModuleRef class.
    query: |
      Where is the ModuleRef class referenced across the codebase?
    expected_state: COMPLETE
    reference_answer: |
      ModuleRef is referenced in packages/core/injector for provider resolution,
      in packages/common for the abstract ModuleRef interface, and across
      test suites and documentation as the API for dynamic provider lookups.
    validations:
      - type: graph_tool_used

  - id: 8049
    name: nestjs_find_references_c
    category: TOOL_HAPPY_PATH
    description: >
      find_references tool against NestJS (test C). Target: ExceptionFilter interface.
    query: |
      Where is the ExceptionFilter interface referenced in the codebase?
    expected_state: COMPLETE
    reference_answer: |
      ExceptionFilter is referenced in packages/common for its definition,
      packages/core/exceptions for the ExceptionsHandler that invokes filters,
      and in UseFilters decorator registration across controllers and methods.
    validations:
      - type: graph_tool_used

  # -- Additional get_call_chain tests (50-51) -- expected_state: COMPLETE --

  - id: 8050
    name: nestjs_get_call_chain_b
    category: TOOL_HAPPY_PATH
    description: >
      get_call_chain tool against NestJS (test B). Target: guard execution pipeline.
    query: |
      Show the call chain from route handler dispatch to guard canActivate execution
    expected_state: COMPLETE
    reference_answer: |
      RouterExplorer.createRequestHandler -> RouterExecutionContext.create ->
      GuardsConsumer.tryActivate -> iterates canActivate on each guard instance
      to determine whether the request proceeds to the handler.
    validations:
      - type: graph_tool_used

  - id: 8051
    name: nestjs_get_call_chain_c
    category: TOOL_HAPPY_PATH
    description: >
      get_call_chain tool against NestJS (test C). Target: module shutdown lifecycle.
    query: |
      Show the call chain from NestApplication.close to module destroy hooks
    expected_state: COMPLETE
    reference_answer: |
      NestApplication.close -> callDestroyHook -> iterates modules calling
      callModuleDestroyHook on each, which invokes onModuleDestroy on providers
      and controllers implementing the OnModuleDestroy interface.
    validations:
      - type: graph_tool_used

  # -- Additional find_path tests (52-53) -- expected_state: COMPLETE --

  - id: 8052
    name: nestjs_find_path_b
    category: TOOL_HAPPY_PATH
    description: >
      find_path tool against NestJS (test B). Target: dependency injection resolution path.
    query: |
      Find the shortest path between module registration and provider instantiation
    expected_state: COMPLETE
    reference_answer: |
      DependenciesScanner.scan -> ModuleCompiler.compile -> InstanceLoader.createInstances ->
      Injector.loadProvider -> resolveConstructorParams -> instantiate the provider class.
    validations:
      - type: graph_tool_used

  - id: 8053
    name: nestjs_find_path_c
    category: TOOL_HAPPY_PATH
    description: >
      find_path tool against NestJS (test C). Target: WebSocket gateway setup.
    query: |
      Find the shortest path between application bootstrap and WebSocket gateway initialization
    expected_state: COMPLETE
    reference_answer: |
      NestApplication.init -> registerModules -> WebSocketModule.register ->
      GatewaysExplorer.explore -> binds gateway handlers to the underlying
      WebSocket server adapter.
    validations:
      - type: graph_tool_used

  # -- Additional find_hotspots tests (54-55) -- expected_state: COMPLETE --

  - id: 8054
    name: nestjs_find_hotspots_b
    category: TOOL_HAPPY_PATH
    description: >
      find_hotspots tool against NestJS (test B). Target: microservices package subsystem.
    query: |
      What are the hotspot functions in the microservices package?
    expected_state: COMPLETE
    reference_answer: |
      Top hotspots in the microservices package include ServerFactory methods,
      ClientProxyFactory.create, and the transport strategy implementations
      (TCP, Redis, NATS) that connect clients to message handlers.
    validations:
      - type: graph_tool_used

  - id: 8055
    name: nestjs_find_hotspots_c
    category: TOOL_HAPPY_PATH
    description: >
      find_hotspots tool against NestJS (test C). Target: functions with highest fan-out.
    query: |
      Which hotspot functions have the highest fan-out in the NestJS codebase?
    expected_state: COMPLETE
    reference_answer: |
      Highest fan-out functions include NestFactory.create which orchestrates
      container setup, NestApplication.init which coordinates multiple subsystem
      registrations, and Injector.loadProvider which resolves dependencies recursively.
    validations:
      - type: graph_tool_used

  # -- Additional find_dead_code tests (56-57) -- expected_state: COMPLETE --

  - id: 8056
    name: nestjs_find_dead_code_b
    category: TOOL_HAPPY_PATH
    description: >
      find_dead_code tool against NestJS (test B). Target: packages/common subsystem.
    query: |
      Find dead code specifically in the packages/common directory
    expected_state: COMPLETE
    reference_answer: |
      Dead code in packages/common includes utility functions and decorator
      helpers with zero incoming call edges that are exported but never
      imported by other packages or internal modules.
    validations:
      - type: graph_tool_used

  - id: 8057
    name: nestjs_find_dead_code_c
    category: TOOL_HAPPY_PATH
    description: >
      find_dead_code tool against NestJS (test C). Target: functions with zero callers excluding exports.
    query: |
      Find internal functions that have no callers and are not exported
    expected_state: COMPLETE
    reference_answer: |
      Internal dead code includes private helper functions in the injector,
      router, and scanner modules that were possibly superseded by refactoring
      but never removed from the source files.
    validations:
      - type: graph_tool_used

  # -- Additional find_cycles tests (58-59) -- expected_state: COMPLETE --

  - id: 8058
    name: nestjs_find_cycles_b
    category: TOOL_HAPPY_PATH
    description: >
      find_cycles tool against NestJS (test B). Target: circular dependencies in the router subsystem.
    query: |
      Find circular call dependencies within the router and middleware subsystem
    expected_state: COMPLETE
    reference_answer: |
      Cycles in the router subsystem involve RoutesResolver, RouterExplorer,
      and MiddlewareModule where route resolution triggers middleware binding
      which may reference back to route metadata scanning.
    validations:
      - type: graph_tool_used

  - id: 8059
    name: nestjs_find_cycles_c
    category: TOOL_HAPPY_PATH
    description: >
      find_cycles tool against NestJS (test C). Target: longest cycle in the codebase.
    query: |
      What is the longest circular dependency chain in this codebase?
    expected_state: COMPLETE
    reference_answer: |
      The longest circular dependency chain contains 22 nodes in the dependency
      injection system: setInstanceByContextId -> cloneStaticInstance ->
      setInstanceByInquirerId -> getStaticModuleToken -> getModuleId -> create
      -> cloneTransientInstance -> reflectCatchExceptions -> getFilterInstance
      -> createConcreteContext -> exchangeKeysForValues -> instance ->
      reflectCallbackParamtypes -> reflectCallbackMetadata -> getMetadata,
      spanning instance-wrapper.ts, module-token-factory.ts, base-exception-filter-context.ts,
      external-context-creator.ts, module.ts, and context-utils.ts.
    validations:
      - type: graph_tool_used

  # -- Additional find_important tests (60-61) -- expected_state: COMPLETE --

  - id: 8060
    name: nestjs_find_important_b
    category: TOOL_HAPPY_PATH
    description: >
      find_important tool against NestJS (test B). Target: packages/core subsystem only.
    query: |
      What are the most important functions by PageRank within packages/core only?
    expected_state: COMPLETE
    reference_answer: |
      Within packages/core, the highest PageRank functions are Injector.loadProvider,
      NestContainer.addModule, InstanceLoader.createInstances, and
      RoutesResolver.resolve which form the critical core infrastructure.
    validations:
      - type: graph_tool_used

  - id: 8061
    name: nestjs_find_important_c
    category: TOOL_HAPPY_PATH
    description: >
      find_important tool against NestJS (test C). Target: least important functions.
    query: |
      What functions have the lowest PageRank scores, indicating they are peripheral?
    expected_state: COMPLETE
    reference_answer: |
      Found 4 most important symbols by PageRank (tool returns highest, not lowest).
      Top results: listen (PageRank 0.000503) in http-server.interface.ts,
      callback (PageRank 0.000488) in nats-client.interface.ts,
      isFunction (PageRank 0.000476) in shared.utils.ts,
      isUndefined (PageRank 0.000472) in shared.utils.ts.
      The tool reports highest PageRank, not lowest — peripheral functions
      are those NOT appearing in the results.
    validations:
      - type: graph_tool_used

  # -- Additional find_communities tests (62-63) -- expected_state: COMPLETE --

  - id: 8062
    name: nestjs_find_communities_b
    category: TOOL_HAPPY_PATH
    description: >
      find_communities tool against NestJS (test B). Target: community structure within packages/core.
    query: |
      What are the natural code communities within the packages/core directory?
    expected_state: COMPLETE
    reference_answer: |
      Within packages/core, communities form around the injector subsystem
      (DI container and provider resolution), the router subsystem (route binding
      and middleware), and the lifecycle subsystem (hooks and shutdown).
    validations:
      - type: graph_tool_used

  - id: 8063
    name: nestjs_find_communities_c
    category: TOOL_HAPPY_PATH
    description: >
      find_communities tool against NestJS (test C). Target: cross-package community boundaries.
    query: |
      Which functions bridge between different code communities across NestJS packages?
    expected_state: COMPLETE
    reference_answer: |
      Bridge functions include NestContainer methods that connect the DI community
      to the router community, and ApplicationConfig that links core configuration
      to platform-specific adapters in platform-express and platform-fastify.
    validations:
      - type: graph_tool_used

  # -- Additional find_articulation_points tests (64-65) -- expected_state: COMPLETE --

  - id: 8064
    name: nestjs_find_articulation_points_b
    category: TOOL_HAPPY_PATH
    description: >
      find_articulation_points tool against NestJS (test B). Target: articulation points in the DI subsystem.
    query: |
      Find single points of failure in the dependency injection subsystem
    expected_state: COMPLETE
    reference_answer: |
      Articulation points in the DI subsystem include Injector.resolveConstructorParams
      which is the sole path for constructor-based injection, and InstanceLoader
      which bridges module scanning to instance creation.
    validations:
      - type: graph_tool_used

  - id: 8065
    name: nestjs_find_articulation_points_c
    category: TOOL_HAPPY_PATH
    description: >
      find_articulation_points tool against NestJS (test C). Target: articulation points connecting packages.
    query: |
      Find articulation points that connect the core package to the microservices package
    expected_state: COMPLETE
    reference_answer: |
      Articulation points bridging core and microservices include the
      NestMicroservice adapter factory and the ServerFactory methods that
      serve as the sole connection between the core DI container and
      transport-layer message handlers.
    validations:
      - type: graph_tool_used

  # -- Additional find_dominators tests (66-67) -- expected_state: COMPLETE --

  - id: 8066
    name: nestjs_find_dominators_b
    category: TOOL_HAPPY_PATH
    description: >
      find_dominators tool against NestJS (test B). Target: provider instantiation.
    query: |
      What functions must execute before a provider is instantiated by the injector?
    expected_state: COMPLETE
    reference_answer: |
      Dominators of provider instantiation include DependenciesScanner.scan,
      ModuleCompiler.compile, InstanceLoader.createInstances, and
      Injector.resolveConstructorParams, all of which must complete before
      the provider constructor is invoked.
    validations:
      - type: graph_tool_used

  - id: 8067
    name: nestjs_find_dominators_c
    category: TOOL_HAPPY_PATH
    description: >
      find_dominators tool against NestJS (test C). Target: middleware execution.
    query: |
      What functions dominate the middleware execution path?
    expected_state: COMPLETE
    reference_answer: |
      Dominators of middleware execution include MiddlewareModule.register,
      MiddlewareBuilder.apply, and RoutesMapper.mapRouteToRouteInfo which
      must all run to set up middleware before any request triggers the chain.
    validations:
      - type: graph_tool_used

  # -- Additional find_loops tests (68-69) -- expected_state: COMPLETE --

  - id: 8068
    name: nestjs_find_loops_b
    category: TOOL_HAPPY_PATH
    description: >
      find_loops tool against NestJS (test B). Target: module import scanning.
    query: |
      Find recursive patterns in module import scanning
    expected_state: COMPLETE
    reference_answer: |
      Recursive patterns in module scanning exist in DependenciesScanner.scanForModules
      which recursively follows module imports, and ModuleCompiler which
      recursively resolves forwardRef and dynamic module definitions.
    validations:
      - type: graph_tool_used

  - id: 8069
    name: nestjs_find_loops_c
    category: TOOL_HAPPY_PATH
    description: >
      find_loops tool against NestJS (test C). Target: microservices package.
    query: |
      Find natural loops and recursive functions in the microservices package
    expected_state: COMPLETE
    reference_answer: |
      Recursive patterns in the microservices package include message retry
      loops in transport strategies, recursive deserialization of nested
      message payloads, and connection retry backoff in client proxies.
    validations:
      - type: graph_tool_used

  # -- Additional find_merge_points tests (70-71) -- expected_state: COMPLETE --

  - id: 8070
    name: nestjs_find_merge_points_b
    category: TOOL_HAPPY_PATH
    description: >
      find_merge_points tool against NestJS (test B). Target: error handling convergence.
    query: |
      Where do different error handling paths converge?
    expected_state: COMPLETE
    reference_answer: |
      Error handling paths converge at ExceptionsHandler.next which receives
      exceptions from guards, interceptors, pipes, and controller methods,
      routing them through the exception filter chain to produce a response.
    validations:
      - type: graph_tool_used

  - id: 8071
    name: nestjs_find_merge_points_c
    category: TOOL_HAPPY_PATH
    description: >
      find_merge_points tool against NestJS (test C). Target: lifecycle hook convergence.
    query: |
      Where do the different lifecycle hook execution paths merge?
    expected_state: COMPLETE
    reference_answer: |
      Lifecycle hooks converge in the NestApplication lifecycle methods where
      onModuleInit, onApplicationBootstrap, onModuleDestroy, and beforeApplicationShutdown
      all funnel through callModuleInitHook/callDestroyHook into the container
      iteration over registered modules.
    validations:
      - type: graph_tool_used

  # -- Additional find_common_dependency tests (72-73) -- expected_state: COMPLETE --

  - id: 8072
    name: nestjs_find_common_dependency_b
    category: TOOL_HAPPY_PATH
    description: >
      find_common_dependency tool against NestJS (test B). Target: RoutesResolver and MiddlewareModule.
    query: |
      What shared dependencies do RoutesResolver and MiddlewareModule have?
    expected_state: COMPLETE
    reference_answer: |
      Both RoutesResolver and MiddlewareModule depend on NestContainer for
      accessing registered modules, ApplicationConfig for global configuration,
      and the Injector for resolving provider instances.
    validations:
      - type: graph_tool_used

  - id: 8073
    name: nestjs_find_common_dependency_c
    category: TOOL_HAPPY_PATH
    description: >
      find_common_dependency tool against NestJS (test C). Target: Pipes and Filters.
    query: |
      What shared dependency do Pipes and ExceptionFilters have?
    expected_state: COMPLETE
    reference_answer: |
      Both Pipes and ExceptionFilters depend on the Injector for instantiation,
      the metadata reflection utilities (Reflector) for reading decorator metadata,
      and the execution context factory for accessing request/response objects.
    validations:
      - type: graph_tool_used

  # -- Additional find_control_dependencies tests (74-75) -- expected_state: COMPLETE --

  - id: 8074
    name: nestjs_find_control_dependencies_b
    category: TOOL_HAPPY_PATH
    description: >
      find_control_dependencies tool against NestJS (test B). Target: guard activation decisions.
    query: |
      What conditionals control whether a guard allows request execution?
    expected_state: COMPLETE
    reference_answer: |
      Guard activation is controlled by the canActivate return value,
      the presence of SetMetadata decorators checked via Reflector,
      and whether the guard is registered at the method, controller, or global level.
    validations:
      - type: graph_tool_used

  - id: 8075
    name: nestjs_find_control_dependencies_c
    category: TOOL_HAPPY_PATH
    description: >
      find_control_dependencies tool against NestJS (test C). Target: module initialization.
    query: |
      What conditionals control whether a module is initialized during bootstrap?
    expected_state: COMPLETE
    reference_answer: |
      Module initialization is controlled by the isModule check in DependenciesScanner,
      dynamic module conditions in ModuleCompiler, the forwardRef resolution,
      and global module flag that determines import visibility.
    validations:
      - type: graph_tool_used

  # -- Additional find_extractable_regions tests (76-77) -- expected_state: COMPLETE --

  - id: 8076
    name: nestjs_find_extractable_regions_b
    category: TOOL_HAPPY_PATH
    description: >
      find_extractable_regions tool against NestJS (test B). Target: packages/core/router directory.
    query: |
      Find extractable regions in the router subsystem
    expected_state: COMPLETE
    reference_answer: |
      SESE regions in RouterExplorer.explore and RoutesResolver.resolve contain
      distinct phases for metadata extraction, handler binding, and middleware
      attachment that could be extracted into focused helper methods.
    validations:
      - type: graph_tool_used

  - id: 8077
    name: nestjs_find_extractable_regions_c
    category: TOOL_HAPPY_PATH
    description: >
      find_extractable_regions tool against NestJS (test C). Target: NestFactory.create method.
    query: |
      Find extractable code regions in NestFactory.create
    expected_state: COMPLETE
    reference_answer: |
      NestFactory.create contains extractable regions for container initialization,
      HTTP adapter creation, logger configuration, and application instance
      assembly, each with clear entry/exit boundaries.
    validations:
      - type: graph_tool_used

  # -- Additional check_reducibility tests (78-79) -- expected_state: COMPLETE --

  - id: 8078
    name: nestjs_check_reducibility_b
    category: TOOL_HAPPY_PATH
    description: >
      check_reducibility tool against NestJS (test B). Target: injector subsystem control flow.
    query: |
      Check the reducibility of the control flow in the injector subsystem
    expected_state: COMPLETE
    reference_answer: |
      The injector subsystem control flow is largely reducible with well-structured
      loops and conditionals, though the forwardRef resolution introduces
      back-edges that complicate the flow graph.
    validations:
      - type: graph_tool_used

  - id: 8079
    name: nestjs_check_reducibility_c
    category: TOOL_HAPPY_PATH
    description: >
      check_reducibility tool against NestJS (test C). Target: compare reducibility across packages.
    query: |
      Compare the control flow reducibility between packages/core and packages/common
    expected_state: COMPLETE
    reference_answer: |
      packages/common has higher reducibility due to simpler decorator and utility
      functions, while packages/core has more complex flow due to recursive DI
      resolution, lifecycle management, and middleware pipeline construction.
    validations:
      - type: graph_tool_used

  # -- Additional find_critical_path tests (80-81) -- expected_state: COMPLETE --

  - id: 8080
    name: nestjs_find_critical_path_b
    category: TOOL_HAPPY_PATH
    description: >
      find_critical_path tool against NestJS (test B). Target: application bootstrap sequence.
    query: |
      What is the critical path from NestFactory.create to application listening?
    expected_state: COMPLETE
    reference_answer: |
      The critical path runs NestFactory.create -> initialize -> DependenciesScanner.scan ->
      InstanceLoader.createInstances -> RoutesResolver.resolve -> NestApplication.listen,
      representing the minimum mandatory sequence to start serving requests.
    validations:
      - type: graph_tool_used

  - id: 8081
    name: nestjs_find_critical_path_c
    category: TOOL_HAPPY_PATH
    description: >
      find_critical_path tool against NestJS (test C). Target: microservice bootstrap.
    query: |
      What is the mandatory call sequence to bootstrap a NestJS microservice?
    expected_state: COMPLETE
    reference_answer: |
      The microservice critical path runs NestFactory.createMicroservice ->
      NestMicroservice constructor -> ServerFactory.create -> transport strategy
      initialization -> listen, setting up the message pattern handlers.
    validations:
      - type: graph_tool_used

  # -- Additional find_module_api tests (82-83) -- expected_state: COMPLETE --

  - id: 8082
    name: nestjs_find_module_api_b
    category: TOOL_HAPPY_PATH
    description: >
      find_module_api tool against NestJS (test B). Target: packages/common package.
    query: |
      What is the public API of the packages/common package?
    expected_state: COMPLETE
    reference_answer: |
      packages/common exports decorators (Controller, Injectable, Module, Get, Post),
      interfaces (NestInterceptor, CanActivate, PipeTransform, ExceptionFilter),
      pipes (ValidationPipe, ParseIntPipe), and utility functions for building
      NestJS applications.
    validations:
      - type: graph_tool_used

  - id: 8083
    name: nestjs_find_module_api_c
    category: TOOL_HAPPY_PATH
    description: >
      find_module_api tool against NestJS (test C). Target: packages/microservices package.
    query: |
      What is the public API of the packages/microservices package?
    expected_state: COMPLETE
    reference_answer: |
      packages/microservices exports ClientProxy, ClientProxyFactory,
      transport strategy classes (ServerTCP, ServerRedis, ServerNATS),
      decorators (MessagePattern, EventPattern), and the NestMicroservice
      application class for building microservice architectures.
    validations:
      - type: graph_tool_used

  # -- Additional find_weighted_criticality tests (84-85) -- expected_state: COMPLETE --

  - id: 8084
    name: nestjs_find_weighted_criticality_b
    category: TOOL_HAPPY_PATH
    description: >
      find_weighted_criticality tool against NestJS (test B). Target: router subsystem.
    query: |
      What are the most critical functions by weighted importance in the router subsystem?
    expected_state: COMPLETE
    reference_answer: |
      In the router subsystem, RoutesResolver.resolve, RouterExplorer.explore,
      and RouterExecutionContext.create rank highest by weighted criticality
      due to their high degree, betweenness, and PageRank scores as the
      sole path for binding and executing route handlers.
    validations:
      - type: graph_tool_used

  - id: 8085
    name: nestjs_find_weighted_criticality_c
    category: TOOL_HAPPY_PATH
    description: >
      find_weighted_criticality tool against NestJS (test C). Target: comparison across subsystems.
    query: |
      Compare the weighted criticality of functions in the DI container versus the router
    expected_state: COMPLETE
    reference_answer: |
      DI container functions like Injector.loadProvider and InstanceLoader.createInstances
      have higher overall weighted criticality than router functions because they
      are called by every module during bootstrap, whereas router functions are
      only active during request handling setup.
    validations:
      - type: graph_tool_used


  # ── IT-24 through IT-42: New tool tests ──

  - id: 8086
    name: nestjs_graph_overview
    category: TOOL_HAPPY_PATH
    description: >
      graph_overview tool against NestJS framework. Get overall graph statistics.
    query: |
      Give me an overview of this codebase's call graph
    expected_state: COMPLETE
    reference_answer: |
      The NestJS framework call graph contains server-side framework
      spanning packages like Module, Controller, Provider, Injectable, DI.
    validations:
      - type: graph_tool_used

  - id: 8087
    name: nestjs_graph_overview_b
    category: TOOL_HAPPY_PATH
    description: >
      graph_overview tool against NestJS framework (test B). Focus on graph density.
    query: |
      How dense is the call graph and what is the average connectivity?
    expected_state: COMPLETE
    reference_answer: |
      The graph has moderate density with most functions having 2-5 callees.
      Hotspot functions have significantly higher degree reflecting the
      core architecture of NestJS framework.
    validations:
      - type: graph_tool_used

  - id: 8088
    name: nestjs_graph_overview_c
    category: TOOL_HAPPY_PATH
    description: >
      graph_overview tool against NestJS framework (test C). Focus on package distribution.
    query: |
      How are functions distributed across packages in the call graph?
    expected_state: COMPLETE
    reference_answer: |
      Functions are distributed across Module, Controller, Provider, Injectable, DI,
      with the core package containing the most edges due to
      orchestration responsibilities.
    validations:
      - type: graph_tool_used

  - id: 8089
    name: nestjs_explore_package
    category: TOOL_HAPPY_PATH
    description: >
      explore_package tool against NestJS framework. Explore core.
    query: |
      Explore the core and show its key types and functions
    expected_state: COMPLETE
    reference_answer: |
      The core contains NestFactory, NestApplication, NestContainer, DI.
    validations:
      - type: graph_tool_used

  - id: 8090
    name: nestjs_explore_package_b
    category: TOOL_HAPPY_PATH
    description: >
      explore_package tool against NestJS framework (test B). Explore common.
    query: |
      Explore the common and show its key types and functions
    expected_state: COMPLETE
    reference_answer: |
      The common contains decorators, pipes, guards, interceptors, filters.
    validations:
      - type: graph_tool_used

  - id: 8091
    name: nestjs_explore_package_c
    category: TOOL_HAPPY_PATH
    description: >
      explore_package tool against NestJS framework (test C). Explore core/router.
    query: |
      Explore the core/router and show its key types and functions
    expected_state: COMPLETE
    reference_answer: |
      The core/router contains RouterExplorer, RoutePathFactory, route mapping.
    validations:
      - type: graph_tool_used

  - id: 8092
    name: nestjs_list_packages
    category: TOOL_HAPPY_PATH
    description: >
      list_packages tool against NestJS framework. List all packages.
    query: |
      List all packages in this codebase
    expected_state: COMPLETE
    reference_answer: |
      Packages include core, common, microservices, websockets, platform-express, platform-fastify, testing.
    validations:
      - type: graph_tool_used

  - id: 8093
    name: nestjs_list_packages_b
    category: TOOL_HAPPY_PATH
    description: >
      list_packages tool against NestJS framework (test B). Focus on count.
    query: |
      How many packages does this codebase have?
    expected_state: COMPLETE
    reference_answer: |
      The codebase has multiple packages organized by concern,
      including core, common, microservices, websockets, platform-express, platform-fastify, testing.
    validations:
      - type: graph_tool_used

  - id: 8094
    name: nestjs_list_packages_c
    category: TOOL_HAPPY_PATH
    description: >
      list_packages tool against NestJS framework (test C). Focus on hierarchy.
    query: |
      Show the package hierarchy and how packages are organized
    expected_state: COMPLETE
    reference_answer: |
      Packages are organized by concern with core, common, microservices, websockets, platform-express, platform-fastify, testing
      as the main functional groupings.
    validations:
      - type: graph_tool_used

  - id: 8095
    name: nestjs_read
    category: TOOL_HAPPY_PATH
    description: >
      Read tool against NestJS framework.
    query: |
      Show me the contents of core/nest-factory.ts
    expected_state: COMPLETE
    reference_answer: |
      NestFactory.create
    validations:
      - type: graph_tool_used

  - id: 8096
    name: nestjs_read_b
    category: TOOL_HAPPY_PATH
    description: >
      Read tool against NestJS framework (test B).
    query: |
      Read the core/nest-application.ts file
    expected_state: COMPLETE
    reference_answer: |
      NestApplication lifecycle
    validations:
      - type: graph_tool_used

  - id: 8097
    name: nestjs_read_c
    category: TOOL_HAPPY_PATH
    description: >
      Read tool against NestJS framework (test C).
    query: |
      Show me the core/injector/container.ts file
    expected_state: COMPLETE
    reference_answer: |
      DI container
    validations:
      - type: graph_tool_used

  - id: 8098
    name: nestjs_trace_request_pipeline
    category: TOOL_HAPPY_PATH
    description: >
      Trace the request handling pipeline in NestJS.
    query: |
      What is the complete call chain from incoming HTTP request to controller method in NestJS?
    expected_state: COMPLETE
    reference_answer: |
      Request handling flows through the HTTP adapter, global middleware,
      guard execution, interceptor chain, pipe validation, controller
      method invocation, and response mapping back through interceptors.
    validations:
      - type: graph_tool_used

  - id: 8099
    name: nestjs_trace_dependency_injection
    category: TOOL_HAPPY_PATH
    description: >
      Trace dependency injection container resolution in NestJS.
    query: |
      How does NestJS resolve and inject dependencies when creating a provider?
    expected_state: COMPLETE
    reference_answer: |
      DI resolution flows through the Injector which scans constructor
      parameters via reflection metadata, recursively resolves each
      dependency from the module's provider registry, handles scope
      (singleton/request/transient), and instantiates the provider.
    validations:
      - type: graph_tool_used

  - id: 8100
    name: nestjs_trace_module_init
    category: TOOL_HAPPY_PATH
    description: >
      Trace module initialization lifecycle in NestJS.
    query: |
      Trace the call chain for NestJS module initialization at startup
    expected_state: COMPLETE
    reference_answer: |
      Module initialization flows through NestFactory.create, which
      scans module metadata, builds the dependency graph, resolves
      imports, registers providers/controllers, calls onModuleInit
      hooks, and starts the HTTP listener.
    validations:
      - type: graph_tool_used

  - id: 8101
    name: nestjs_trace_guard_execution
    category: TOOL_HAPPY_PATH
    description: >
      Trace guard execution flow in NestJS.
    query: |
      What functions are involved when NestJS evaluates route guards?
    expected_state: COMPLETE
    reference_answer: |
      Guard execution flows through the GuardsConsumer which collects
      global, controller, and handler-level guards, calls canActivate
      on each sequentially, and short-circuits with ForbiddenException
      if any guard returns false.
    validations:
      - type: graph_tool_used

  - id: 8102
    name: nestjs_trace_interceptor_chain
    category: TOOL_HAPPY_PATH
    description: >
      Trace interceptor chain execution in NestJS.
    query: |
      How do NestJS interceptors wrap the handler execution?
    expected_state: COMPLETE
    reference_answer: |
      Interceptors form an RxJS Observable chain via InterceptorsConsumer.
      Each interceptor's intercept() receives an ExecutionContext and
      CallHandler, can transform the response stream, add logging,
      or modify the result through Observable operators.
    validations:
      - type: graph_tool_used

  - id: 8103
    name: nestjs_trace_pipe_validation
    category: TOOL_HAPPY_PATH
    description: >
      Trace validation pipe execution in NestJS.
    query: |
      What is the call path for request body validation through pipes?
    expected_state: COMPLETE
    reference_answer: |
      Pipe validation flows through PipesConsumer which calls each
      pipe's transform method. ValidationPipe uses class-transformer
      to instantiate the DTO, class-validator to validate constraints,
      and throws BadRequestException on validation failure.
    validations:
      - type: graph_tool_used

  - id: 8104
    name: nestjs_glob
    category: TOOL_HAPPY_PATH
    description: >
      Glob tool against NestJS framework.
    query: |
      Find all files matching core/**/*.ts
    expected_state: COMPLETE
    reference_answer: |
      The Glob tool processes core/**/*.ts for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8105
    name: nestjs_glob_b
    category: TOOL_HAPPY_PATH
    description: >
      Glob tool against NestJS framework (test B).
    query: |
      Find files matching common/decorators/*.ts
    expected_state: COMPLETE
    reference_answer: |
      The Glob tool processes common/decorators/*.ts for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8106
    name: nestjs_glob_c
    category: TOOL_HAPPY_PATH
    description: >
      Glob tool against NestJS framework (test C).
    query: |
      Search for core/injector/*.ts files
    expected_state: COMPLETE
    reference_answer: |
      The Glob tool processes core/injector/*.ts for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8107
    name: nestjs_grep
    category: TOOL_HAPPY_PATH
    description: >
      Grep tool against NestJS framework.
    query: |
      Search for @Injectable usage in the codebase
    expected_state: COMPLETE
    reference_answer: |
      The Grep tool processes @Injectable usage for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8108
    name: nestjs_grep_b
    category: TOOL_HAPPY_PATH
    description: >
      Grep tool against NestJS framework (test B).
    query: |
      Find all @Module decorator
    expected_state: COMPLETE
    reference_answer: |
      The Grep tool processes @Module decorator for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8109
    name: nestjs_grep_c
    category: TOOL_HAPPY_PATH
    description: >
      Grep tool against NestJS framework (test C).
    query: |
      Search for Reflect.getMetadata
    expected_state: COMPLETE
    reference_answer: |
      Searched the NestJS codebase for Reflect.getMetadata and found no occurrences.
      The NestJS framework uses the reflect-metadata package but the literal
      Reflect.getMetadata call does not appear in the source code within the
      packages/ directory scope.
    validations:
      - type: graph_tool_used

  - id: 8110
    name: nestjs_diff
    category: TOOL_HAPPY_PATH
    description: >
      Diff tool against NestJS framework.
    query: |
      Compare platform-express vs platform-fastify
    expected_state: COMPLETE
    reference_answer: |
      The Diff tool processes platform-express vs platform-fastify for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8111
    name: nestjs_diff_b
    category: TOOL_HAPPY_PATH
    description: >
      Diff tool against NestJS framework (test B).
    query: |
      Show differences between Guard vs Interceptor
    expected_state: COMPLETE
    reference_answer: |
      The Diff tool processes Guard vs Interceptor for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8112
    name: nestjs_diff_c
    category: TOOL_HAPPY_PATH
    description: >
      Diff tool against NestJS framework (test C).
    query: |
      Compare Pipe vs Filter
    expected_state: COMPLETE
    reference_answer: |
      The Diff tool processes Pipe vs Filter for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8113
    name: nestjs_tree
    category: TOOL_HAPPY_PATH
    description: >
      Tree tool against NestJS framework.
    query: |
      Show the packages/core structure
    expected_state: COMPLETE
    reference_answer: |
      The Tree tool processes packages/core structure for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8114
    name: nestjs_tree_b
    category: TOOL_HAPPY_PATH
    description: >
      Tree tool against NestJS framework (test B).
    query: |
      Show the packages/common structure structure
    expected_state: COMPLETE
    reference_answer: |
      The Tree tool processes packages/common structure for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8115
    name: nestjs_tree_c
    category: TOOL_HAPPY_PATH
    description: >
      Tree tool against NestJS framework (test C).
    query: |
      Display the packages/microservices layout
    expected_state: COMPLETE
    reference_answer: |
      The Tree tool processes packages/microservices for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8116
    name: nestjs_trace_exception_filter
    category: TOOL_HAPPY_PATH
    description: >
      Trace exception filter handling in NestJS.
    query: |
      How does NestJS route exceptions to the appropriate exception filter?
    expected_state: COMPLETE
    reference_answer: |
      Exception handling flows through ExceptionsHandler which catches
      thrown exceptions, searches for matching exception filters from
      handler to controller to global level, and delegates to the
      filter's catch method or the default BaseExceptionFilter.
    validations:
      - type: graph_tool_used

  - id: 8117
    name: nestjs_trace_middleware_apply
    category: TOOL_HAPPY_PATH
    description: >
      Trace middleware application in NestJS.
    query: |
      What functions apply middleware to routes in NestJS?
    expected_state: COMPLETE
    reference_answer: |
      Middleware application flows through MiddlewareModule which
      resolves middleware from the configure method, matches routes
      via RoutesMapper, and registers them with the HTTP adapter
      in the correct execution order.
    validations:
      - type: graph_tool_used

  - id: 8118
    name: nestjs_trace_websocket_gateway
    category: TOOL_HAPPY_PATH
    description: >
      Trace WebSocket gateway message handling in NestJS.
    query: |
      How does NestJS route incoming WebSocket messages to gateway handlers?
    expected_state: COMPLETE
    reference_answer: |
      WebSocket message handling flows through the WebSocketGateway
      which registers with the IoAdapter, listens for events matching
      @SubscribeMessage decorators, pipes messages through the same
      guard/interceptor/pipe chain as HTTP, and emits responses.
    validations:
      - type: graph_tool_used

  - id: 8119
    name: nestjs_validate_syntax
    category: TOOL_HAPPY_PATH
    description: >
      validate_syntax tool against NestJS framework.
    query: |
      Validate the syntax of core/nest-factory.ts
    expected_state: COMPLETE
    reference_answer: |
      The validate_syntax tool processes core/nest-factory.ts for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8120
    name: nestjs_validate_syntax_b
    category: TOOL_HAPPY_PATH
    description: >
      validate_syntax tool against NestJS framework (test B).
    query: |
      Check the syntax of core/nest-application.ts
    expected_state: COMPLETE
    reference_answer: |
      The validate_syntax tool processes core/nest-application.ts for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8121
    name: nestjs_validate_syntax_c
    category: TOOL_HAPPY_PATH
    description: >
      validate_syntax tool against NestJS framework (test C).
    query: |
      Verify the syntax of common/decorators/core.ts
    expected_state: COMPLETE
    reference_answer: |
      The validate_syntax tool processes common/decorators/core.ts for
      the NestJS framework codebase.
    validations:
      - type: graph_tool_used

  - id: 8122
    name: nestjs_find_entry_points_b
    category: TOOL_HAPPY_PATH
    description: >
      find_entry_points tool against NestJS framework (test B). Focus on NestFactory.create.
    query: |
      NestFactory.create
    expected_state: COMPLETE
    reference_answer: |
      bootstrap, HTTP adapter, listen
    validations:
      - type: graph_tool_used

  - id: 8123
    name: nestjs_find_entry_points_c
    category: TOOL_HAPPY_PATH
    description: >
      find_entry_points tool against NestJS framework (test C). Focus on module scanning.
    query: |
      module scanning in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      DependenciesScanner, ModuleCompiler, InstanceLoader
    validations:
      - type: graph_tool_used

  - id: 8124
    name: nestjs_trace_data_flow_b
    category: TOOL_HAPPY_PATH
    description: >
      trace_data_flow tool against NestJS framework (test B). Focus on request pipeline.
    query: |
      request pipeline in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      middleware, guard, interceptor, pipe, handler
    validations:
      - type: graph_tool_used

  - id: 8125
    name: nestjs_trace_data_flow_c
    category: TOOL_HAPPY_PATH
    description: >
      trace_data_flow tool against NestJS framework (test C). Focus on DI resolution.
    query: |
      DI resolution
    expected_state: COMPLETE
    reference_answer: |
      ModuleRef, provider tokens, inject metadata, instances
    validations:
      - type: graph_tool_used

  - id: 8126
    name: nestjs_trace_error_flow_b
    category: TOOL_HAPPY_PATH
    description: >
      trace_error_flow tool against NestJS framework (test B). Focus on exception filters.
    query: |
      exception filters in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      ExceptionFilter, HttpException, catch, BaseExceptionFilter
    validations:
      - type: graph_tool_used

  - id: 8127
    name: nestjs_trace_error_flow_c
    category: TOOL_HAPPY_PATH
    description: >
      trace_error_flow tool against NestJS framework (test C). Focus on DI errors.
    query: |
      DI errors
    expected_state: COMPLETE
    reference_answer: |
      circular dependency, unknown provider, missing module
    validations:
      - type: graph_tool_used

  - id: 8128
    name: nestjs_build_minimal_context_b
    category: TOOL_HAPPY_PATH
    description: >
      build_minimal_context tool against NestJS framework (test B). Focus on DI container.
    query: |
      DI container
    expected_state: COMPLETE
    reference_answer: |
      NestContainer, Module, Provider, InstanceWrapper
    validations:
      - type: graph_tool_used

  - id: 8129
    name: nestjs_build_minimal_context_c
    category: TOOL_HAPPY_PATH
    description: >
      build_minimal_context tool against NestJS framework (test C). Focus on route setup.
    query: |
      route setup in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      RouterExplorer, RoutePathFactory, RequestMethod mapping
    validations:
      - type: graph_tool_used

  - id: 8130
    name: nestjs_find_similar_code_b
    category: TOOL_HAPPY_PATH
    description: >
      find_similar_code tool against NestJS framework (test B). Focus on enhancer patterns.
    query: |
      enhancer patterns in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      Guard/Interceptor/Pipe all use similar binding pattern
    validations:
      - type: graph_tool_used

  - id: 8131
    name: nestjs_find_similar_code_c
    category: TOOL_HAPPY_PATH
    description: >
      find_similar_code tool against NestJS framework (test C). Focus on platform adapters.
    query: |
      platform adapters in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      express/fastify adapters implement same HttpAdapter
    validations:
      - type: graph_tool_used

  - id: 8132
    name: nestjs_find_config_usage_b
    category: TOOL_HAPPY_PATH
    description: >
      find_config_usage tool against NestJS framework (test B). Focus on app options.
    query: |
      app options in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      NestApplicationOptions, cors, bodyParser, globalPrefix
    validations:
      - type: graph_tool_used

  - id: 8133
    name: nestjs_find_config_usage_c
    category: TOOL_HAPPY_PATH
    description: >
      find_config_usage tool against NestJS framework (test C). Focus on module config.
    query: |
      module config in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      ConfigModule, forRoot, forRootAsync, register
    validations:
      - type: graph_tool_used

  - id: 8134
    name: nestjs_summarize_file_b
    category: TOOL_HAPPY_PATH
    description: >
      summarize_file tool against NestJS framework (test B). Focus on core/injector/injector.ts.
    query: |
      core/injector/injector.ts in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      dependency injection, provider resolution
    validations:
      - type: graph_tool_used

  - id: 8135
    name: nestjs_summarize_file_c
    category: TOOL_HAPPY_PATH
    description: >
      summarize_file tool against NestJS framework (test C). Focus on core/scanner.ts.
    query: |
      core/scanner.ts in NestJS framework?
    expected_state: COMPLETE
    reference_answer: |
      DependenciesScanner, module tree walking
    validations:
      - type: graph_tool_used

  # -- GR-58: CRS TraceStep Verification Tests --

  - id: 8136
    name: nestjs_crs_find_callers
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58: Verify find_callers produces CRS TraceStep. Target: MetadataScanner.getAllMethodNames.
    query: |
      Who calls the MetadataScanner.getAllMethodNames method?
    expected_state: COMPLETE
    reference_answer: |
      find_callers tool was used and produced a CRS TraceStep recording the query
      for MetadataScanner.getAllMethodNames with match_count, total_callers, and used_inheritance_path metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8137
    name: nestjs_crs_find_callees
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58: Verify find_callees produces CRS TraceStep. Target: NestApplication.listen.
    query: |
      What functions does NestApplication.listen call?
    expected_state: COMPLETE
    reference_answer: |
      find_callees tool was used and produced a CRS TraceStep recording the query
      for NestApplication.listen with resolved_count, external_count, and total_count metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  # -- GR-58: CRS TraceStep Verification (IT-03 to IT-42) --

  - id: 8138
    name: nestjs_crs_find_references
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-06: Verify find_references produces CRS TraceStep against NestJS.
    query: |
      Find all references to the Injectable decorator in NestJS.
    expected_state: COMPLETE
    reference_answer: |
      find_references tool was used and produced a CRS TraceStep with
      reference_count and symbol_matches metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8139
    name: nestjs_crs_find_important
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-10: Verify find_important produces CRS TraceStep against NestJS.
    query: |
      Find the most important nodes in NestJS's dependency injection system.
    expected_state: COMPLETE
    reference_answer: |
      find_important tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8140
    name: nestjs_crs_find_merge_points
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-15: Verify find_merge_points produces CRS TraceStep against NestJS.
    query: |
      Find merge points in NestJS's module resolution call graph.
    expected_state: COMPLETE
    reference_answer: |
      find_merge_points tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8141
    name: nestjs_crs_check_reducibility
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-19: Verify check_reducibility produces CRS TraceStep against NestJS.
    query: |
      Check the reducibility of NestJS's request handling call graph.
    expected_state: COMPLETE
    reference_answer: |
      check_reducibility tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8142
    name: nestjs_crs_graph_overview
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-24: Verify graph_overview produces CRS TraceStep against NestJS.
    query: |
      Show an overview of the NestJS core module dependency graph.
    expected_state: COMPLETE
    reference_answer: |
      graph_overview tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8143
    name: nestjs_crs_find_entry_points
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-28: Verify find_entry_points produces CRS TraceStep against NestJS.
    query: |
      Find entry points in NestJS's core module.
    expected_state: COMPLETE
    reference_answer: |
      find_entry_points tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8144
    name: nestjs_crs_find_config_usage
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-33: Verify find_config_usage produces CRS TraceStep against NestJS.
    query: |
      Find configuration usage patterns in NestJS.
    expected_state: COMPLETE
    reference_answer: |
      find_config_usage tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8145
    name: nestjs_crs_glob
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-37: Verify glob tool produces CRS TraceStep against NestJS.
    query: |
      Find all TypeScript files matching *module*.ts in NestJS.
    expected_state: COMPLETE
    reference_answer: |
      glob tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8146
    name: nestjs_crs_validate_syntax
    category: TOOL_CRS_VERIFICATION
    description: >
      GR-58/IT-42: Verify validate_syntax produces CRS TraceStep against NestJS.
    query: |
      Validate the syntax of NestJS's app.module.ts file.
    expected_state: COMPLETE
    reference_answer: |
      validate_syntax tool was used and produced a CRS TraceStep with appropriate metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  # -- IT-01/IT-02/IT-03: Second CRS TraceStep Verification --

  - id: 8147
    name: nestjs_crs_find_callers_b
    category: TOOL_CRS_VERIFICATION
    description: >
      IT-01: Second CRS verification for find_callers against NestJS. Target: NestApplication.init.
    query: |
      Who calls the NestApplication.init method in NestJS?
    expected_state: COMPLETE
    reference_answer: |
      find_callers tool was used and produced a CRS TraceStep with
      match_count, total_callers, and used_inheritance_path metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8148
    name: nestjs_crs_find_callees_b
    category: TOOL_CRS_VERIFICATION
    description: >
      IT-02: Second CRS verification for find_callees against NestJS. Target: ModuleCompiler.compile.
    query: |
      What functions does ModuleCompiler.compile call in NestJS?
    expected_state: COMPLETE
    reference_answer: |
      find_callees tool was used and produced a CRS TraceStep with
      resolved_count, external_count, and total_count metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8149
    name: nestjs_crs_find_implementations_a
    category: TOOL_CRS_VERIFICATION
    description: >
      IT-03: First CRS verification for find_implementations against NestJS. Target: NestInterceptor.
    query: |
      What classes implement the NestInterceptor interface in NestJS?
    expected_state: COMPLETE
    reference_answer: |
      find_implementations tool was used and produced a CRS TraceStep with
      match_count, total_implementations, and index_used metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present

  - id: 8150
    name: nestjs_crs_find_implementations_b
    category: TOOL_CRS_VERIFICATION
    description: >
      IT-03: Second CRS verification for find_implementations against NestJS. Target: CanActivate.
    query: |
      What classes implement the CanActivate interface in NestJS?
    expected_state: COMPLETE
    reference_answer: |
      find_implementations tool was used and produced a CRS TraceStep with
      match_count, total_implementations, and index_used metadata.
    validations:
      - type: graph_tool_used
      - type: crs_trace_step_present
